<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Slovak Words Trainer - –¢–µ–º—ã</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
        }
        
        :root {
            --primary: #58cc02;
            --primary-dark: #47a802;
            --secondary: #1cb0f6;
            --danger: #ff4b4b;
            --warning: #ff9500;
            --light: #f8f9fa;
            --dark: #333;
            --gray: #6c757d;
            --light-gray: #e9ecef;
            --border-radius: 16px;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            --transition: all 0.2s ease;
        }
        
        body {
            margin: 0;
            min-height: 100vh;
            background: var(--light);
            color: var(--dark);
            touch-action: manipulation;
            -webkit-font-smoothing: antialiased;
        }
        
        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä ‚Äî –Ω–∞ –≤–µ—Å—å –µ–∫—Ä–∞–Ω, —è–∫ –∑–≤–∏—á–∞–π–Ω–∏–π —Å–∞–π—Ç */
        .app-container {
            width: 100%;
            min-height: 100vh;
            max-width: 100%;
            margin: 0 auto;
            background: var(--light);
            display: flex;
            flex-direction: column;
        }
        
        @media (min-width: 520px) {
            .app-container {
                max-width: 500px;
                box-shadow: 0 0 0 1px var(--light-gray);
            }
        }
        
        /* Header */
        .app-header {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            padding: 16px 16px 16px 14px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 10px;
            flex-shrink: 0;
            position: relative;
        }
        
        .logo {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 1.2rem;
            font-weight: bold;
            text-align: center;
            max-width: calc(100% - 110px);
            pointer-events: none;
        }
        
        .logo i {
            font-size: 1.5rem;
            flex-shrink: 0;
        }
        
        .logo span {
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            line-clamp: 2;
            line-height: 1.3;
        }
        
        /* –í–µ–∑–¥–µ –∫—Ä–æ–º–µ –≥–ª–∞–≤–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞: –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å–ª–µ–≤–∞, –∫–Ω–æ–ø–∫–∏ –ø—Ä–∏–∂–∞—Ç—ã –∫ –ø—Ä–∞–≤–æ–º—É –∫—Ä–∞—é */
        .app-header.header--left .logo {
            position: static;
            left: auto;
            transform: none;
            flex: 1;
            min-width: 0;
            max-width: none;
            justify-content: flex-start;
            text-align: left;
            pointer-events: auto;
            padding-right: 12px;
        }
        .app-header.header--left .logo span {
            -webkit-line-clamp: 2;
            line-clamp: 2;
        }
        .app-header.header--left .header-actions {
            flex-shrink: 0;
            margin-left: auto;
        }
        .app-header.header--left .header-spacer {
            display: none;
        }
        
        .header-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .back-btn {
            position: relative;
            z-index: 1;
        }
        .header-actions {
            position: relative;
            z-index: 1;
        }
        .back-btn, .reset-btn, .sound-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1rem;
        }
        
        @media (hover: hover) {
            .back-btn:hover, .reset-btn:hover, .sound-btn:hover {
                background: rgba(255, 255, 255, 0.35);
                transform: scale(1.08);
            }
        }
        .back-btn:active, .reset-btn:active, .sound-btn:active {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(0.95);
        }
        
        .reset-btn, .sound-btn {
            font-size: 0.9rem;
        }
        
        .sound-btn.active {
            background: rgba(255, 255, 255, 0.4);
        }
        
        /* Progress bar */
        .progress-container {
            padding: 12px 15px;
            background: var(--light);
            border-bottom: 1px solid var(--light-gray);
            flex-shrink: 0;
        }
        
        .progress-text {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.85rem;
            color: var(--gray);
        }
        
        .progress-bar {
            height: 8px;
            background: var(--light-gray);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            border-radius: 4px;
            width: 0%;
            transition: width 0.5s ease;
        }
        
        /* Screen —Å—Ç–∏–ª–∏ */
        .screen {
            display: none;
            flex: 1;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .screen.active {
            display: flex;
            flex-direction: column;
        }
        
        /* –≠–∫—Ä–∞–Ω –≤—ã–±–æ—Ä–∞ —Ç–µ–º—ã */
        .topics-screen {
            padding: 25px 15px;
            text-align: center;
            overflow-y: auto;
        }
        
        .topics-title {
            font-size: 1.6rem;
            margin-bottom: 8px;
            color: var(--dark);
        }
        
        .topics-subtitle {
            color: var(--gray);
            margin-bottom: 25px;
            font-size: 0.95rem;
            line-height: 1.4;
        }
        
        .all-words-btn {
            background: linear-gradient(135deg, #7c4dff 0%, #b388ff 50%, #651fff 100%);
            color: white;
            border: none;
            padding: 16px 20px 14px;
            border-radius: 18px;
            font-size: 1.05rem;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            align-items: stretch;
            gap: 10px;
            margin-bottom: 28px;
            width: 100%;
            box-shadow: 0 4px 16px rgba(101, 31, 255, 0.3);
            position: relative;
            overflow: hidden;
        }
        .all-words-btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(180deg, rgba(255,255,255,0.15) 0%, transparent 50%);
            pointer-events: none;
            border-radius: inherit;
        }
        .all-words-btn-row {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 14px;
            position: relative;
            z-index: 1;
        }
        .all-words-btn-emoji {
            font-size: 1.5rem;
            line-height: 1;
        }
        .all-words-btn-text {
            letter-spacing: 0.02em;
        }
        .all-words-btn-count {
            margin-left: 6px;
            padding: 4px 10px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            opacity: 0.95;
        }
        .all-words-btn-progress-wrap {
            display: flex;
            align-items: center;
            gap: 10px;
            position: relative;
            z-index: 1;
        }
        .all-words-btn-progress-bar {
            flex: 1;
            height: 6px;
            background: rgba(255, 255, 255, 0.35);
            border-radius: 3px;
            overflow: hidden;
        }
        .all-words-btn-progress-fill {
            display: block;
            height: 100%;
            width: 0%;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 3px;
            transition: width 0.4s ease;
        }
        .all-words-btn-progress-text {
            font-size: 0.75rem;
            font-weight: 600;
            opacity: 0.95;
            min-width: 38px;
            text-align: right;
        }
        @media (hover: hover) {
            .all-words-btn:hover {
                transform: translateY(-3px) scale(1.01);
                box-shadow: 0 8px 24px rgba(101, 31, 255, 0.4);
            }
        }
        .all-words-btn:active {
            transform: scale(0.98);
            opacity: 0.95;
        }
        
        .topics-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 10px;
        }
        
        .topic-card {
            background: var(--light);
            border-radius: var(--border-radius);
            padding: 20px;
            text-align: left;
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid transparent;
            display: flex;
            align-items: center;
            gap: 15px;
            touch-action: manipulation;
            position: relative;
        }
        
        @media (hover: hover) {
            .topic-card:hover {
                transform: translateY(-2px) scale(1.01);
                border-color: var(--primary);
                box-shadow: var(--shadow);
            }
        }
        .topic-card:active {
            transform: scale(0.98);
            border-color: var(--primary);
            box-shadow: var(--shadow);
        }
        
        .topic-icon {
            width: 45px;
            height: 45px;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.3rem;
            flex-shrink: 0;
        }
        
        .topic-info {
            flex: 1;
        }
        
        .topic-info h3 {
            font-size: 1.2rem;
            margin-bottom: 5px;
            color: var(--dark);
        }
        
        .topic-info p {
            color: var(--gray);
            font-size: 0.85rem;
            line-height: 1.4;
        }
        
        .topic-stats {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.8rem;
            color: var(--gray);
        }
        
        .topic-progress {
            background: var(--light-gray);
            height: 4px;
            border-radius: 2px;
            flex: 1;
            overflow: hidden;
        }
        
        .topic-progress-fill {
            height: 100%;
            background: var(--primary);
            border-radius: 2px;
            width: 0%;
        }
        
        /* –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π */
        .main-screen {
            padding: 25px 15px;
            text-align: center;
            overflow-y: auto;
        }
        
        .main-title {
            font-size: 1.6rem;
            margin-bottom: 8px;
            color: var(--dark);
        }
        
        .main-subtitle {
            color: var(--gray);
            margin-bottom: 30px;
            font-size: 0.95rem;
            line-height: 1.4;
        }
        
        .current-topic {
            display: none;
        }
        
        .exercise-cards {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }
        
        .exercise-card {
            background: var(--light);
            border-radius: var(--border-radius);
            padding: 20px;
            text-align: left;
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid transparent;
            display: flex;
            align-items: center;
            gap: 15px;
            touch-action: manipulation;
        }
        
        @media (hover: hover) {
            .exercise-card:hover {
                transform: translateY(-2px) scale(1.01);
                border-color: var(--primary);
                box-shadow: var(--shadow);
            }
        }
        .exercise-card:active {
            transform: scale(0.98);
            border-color: var(--primary);
            box-shadow: var(--shadow);
        }
        
        .exercise-icon {
            width: 45px;
            height: 45px;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.3rem;
            flex-shrink: 0;
        }
        
        .exercise-info h3 {
            font-size: 1.2rem;
            margin-bottom: 5px;
            color: var(--dark);
        }
        
        .exercise-info p {
            color: var(--gray);
            font-size: 0.85rem;
            line-height: 1.4;
        }
        
        /* –ö–Ω–æ–ø–∫–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤—Å–µ—Ö —Å–ª–æ–≤ */
        .view-words-btn {
            background: linear-gradient(to right, #9c27b0, #673ab7);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: var(--border-radius);
            font-size: 0.95rem;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            touch-action: manipulation;
            margin-top: 20px;
            width: 100%;
        }
        
        @media (hover: hover) {
            .view-words-btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 16px rgba(156, 39, 176, 0.3);
            }
        }
        .view-words-btn:active {
            transform: scale(0.98);
        }
        
        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid var(--light-gray);
        }
        
        .stat-item {
            text-align: center;
            background: var(--light);
            padding: 15px 10px;
            border-radius: var(--border-radius);
        }
        
        .stat-value {
            font-size: 1.6rem;
            font-weight: bold;
            color: var(--primary);
        }
        
        .stat-label {
            font-size: 0.75rem;
            color: var(--gray);
            margin-top: 4px;
        }
        
        /* –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π –Ω–∞ —ç–∫—Ä–∞–Ω–µ —Ç–µ–º—ã */
        .theme-action-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 20px;
        }
        
        .theme-action-btn {
            border: none;
            padding: 14px 18px;
            border-radius: 14px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.15s ease, box-shadow 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            touch-action: manipulation;
            position: relative;
            box-shadow: 0 3px 12px rgba(0, 0, 0, 0.08);
        }
        
        @media (hover: hover) {
            .theme-action-btn:hover {
                transform: translateY(-2px) scale(1.02);
                box-shadow: 0 5px 18px rgba(0, 0, 0, 0.12);
            }
        }
        .theme-action-btn:active {
            transform: scale(0.98);
        }
        
        /* –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –æ—à–∏–±–∫–∏ */
        .theme-action-btn--repeat {
            background: linear-gradient(135deg, #ff9500 0%, #ffb347 50%, #ffcc70 100%);
            color: #5d3a00;
        }
        
        .theme-action-btn--repeat .theme-action-btn-icon {
            font-size: 1.1rem;
            opacity: 0.95;
        }
        
        .theme-action-btn-count {
            margin-left: 4px;
            background: rgba(93, 58, 0, 0.25);
            color: #3d2600;
            padding: 2px 8px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.9rem;
            min-width: 28px;
            text-align: center;
        }
        
        /* –°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å —Ç–µ–º—ã */
        .theme-action-btn--reset {
            background: #fff;
            color: var(--danger);
            border: 2px solid rgba(255, 75, 75, 0.5);
        }
        
        .theme-action-btn--reset .theme-action-btn-icon {
            font-size: 0.95rem;
            opacity: 0.9;
        }
        
        /* –≠–∫—Ä–∞–Ω —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è 1 */
        .exercise1-screen {
            padding: 20px 15px;
            overflow-y: auto;
        }
        
        /* –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —è–∑—ã–∫–∞ */
        .language-switcher {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            background: var(--light);
            padding: 10px;
            border-radius: var(--border-radius);
            border: 2px solid var(--light-gray);
        }
        
        .language-option {
            flex: 1;
            padding: 10px 15px;
            border-radius: var(--border-radius);
            background: white;
            border: 2px solid var(--light-gray);
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            font-size: 0.9rem;
        }
        
        @media (hover: hover) {
            .language-option:hover:not(.active) {
                transform: scale(1.02);
                border-color: var(--secondary);
                background: rgba(28, 176, 246, 0.08);
            }
        }
        .language-option.active {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            border-color: var(--primary);
            font-weight: bold;
        }
        
        .language-flag {
            font-size: 1.2rem;
            margin-right: 5px;
        }
        
        .word-card {
            background: var(--light);
            border-radius: var(--border-radius);
            padding: 25px 20px;
            text-align: center;
            margin-bottom: 25px;
            border: 2px solid var(--light-gray);
            position: relative;
        }
        
        .word-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 5px;
        }
        
        .word-sl {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--dark);
            word-break: break-word;
        }
        
        .word-ru {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--dark);
            word-break: break-word;
        }
        
        .pronunciation-btn {
            background: var(--secondary);
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1rem;
            flex-shrink: 0;
        }
        
        @media (hover: hover) {
            .pronunciation-btn:hover {
                transform: scale(1.1);
                background: var(--primary);
                box-shadow: 0 4px 12px rgba(88, 204, 2, 0.4);
            }
        }
        .pronunciation-btn:active {
            transform: scale(0.95);
            background: var(--primary);
        }
        
        .pronunciation {
            font-size: 1.1rem;
            color: var(--gray);
            font-style: italic;
            margin-bottom: 12px;
            min-height: 1.3em;
        }
        
        .direction-hint {
            color: var(--gray);
            font-size: 0.9rem;
            margin-top: 5px;
            font-style: italic;
        }
        
        /* –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 1: –£–º–µ–Ω—å—à–µ–Ω–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
        .options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .option-btn {
            padding: 14px 10px;
            border-radius: var(--border-radius);
            border: 2px solid var(--light-gray);
            background: white;
            font-size: 0.9rem;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
            touch-action: manipulation;
            min-height: 55px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.3;
        }
        
        @media (hover: hover) {
            .option-btn:hover:not(:disabled) {
                transform: translateY(-1px) scale(1.02);
                border-color: var(--secondary);
                box-shadow: 0 4px 12px rgba(28, 176, 246, 0.2);
            }
        }
        .option-btn:active:not(:disabled) {
            transform: scale(0.98);
        }
        
        .option-btn.correct {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .option-btn.wrong {
            background: var(--danger);
            color: white;
            border-color: var(--danger);
        }
        
        .option-btn:disabled {
            cursor: default;
            opacity: 0.9;
        }
        
        .feedback {
            padding: 15px;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: bold;
            font-size: 1rem;
            margin-top: 15px;
            display: none;
            animation: fadeIn 0.3s ease;
        }
        
        .feedback.correct {
            background: rgba(88, 204, 2, 0.1);
            color: var(--primary-dark);
            display: block;
        }
        
        .feedback.wrong {
            background: rgba(255, 75, 75, 0.1);
            color: var(--danger);
            display: block;
        }
        
        /* –≠–∫—Ä–∞–Ω —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è 2 */
        .exercise2-screen {
            padding: 20px 15px;
            overflow-y: auto;
        }
        
        .matching-title {
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.2rem;
            color: var(--dark);
        }
        
        .matching-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            flex: 1;
        }
        
        .words-columns-wrapper {
            display: flex;
            gap: 15px;
        }
        
        .words-column {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 10px;
            min-height: 300px;
        }
        
        .word-item {
            padding: 16px 12px;
            border-radius: var(--border-radius);
            border: 2px solid var(--light-gray);
            background: white;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
            font-size: 0.95rem;
            min-height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
            word-break: break-word;
            touch-action: manipulation;
            line-height: 1.4;
            position: relative;
            margin-bottom: 5px;
        }
        
        @media (hover: hover) {
            .word-item:hover:not(.matched) {
                transform: translateY(-2px) scale(1.01);
                border-color: var(--secondary);
                box-shadow: 0 4px 12px rgba(28, 176, 246, 0.15);
            }
        }
        .word-item:active:not(.matched) {
            transform: scale(0.98);
        }
        
        .word-item.selected {
            border-color: var(--warning);
            background: rgba(255, 149, 0, 0.1);
            box-shadow: 0 2px 8px rgba(255, 149, 0, 0.2);
        }
        
        .word-item.matched {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            cursor: default;
            margin-top: 5px;
            margin-bottom: 5px;
        }
        
        .word-item.wrong {
            background: var(--danger);
            color: white;
            border-color: var(--danger);
            animation: wrongShake 0.5s ease;
        }
        
        /* –ö–Ω–æ–ø–∫–∞ –æ–∑–≤—É—á–∫–∏ –≤ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–∏ 2 */
        .sound-icon {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 24px;
            height: 24px;
            background: var(--secondary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.7rem;
            cursor: pointer;
            opacity: 0.7;
            transition: var(--transition);
        }
        
        @media (hover: hover) {
            .sound-icon:hover {
                opacity: 1;
                transform: scale(1.1);
            }
        }
        .sound-icon:active {
            opacity: 1;
            transform: scale(1.1);
        }

        /* –≠–∫—Ä–∞–Ω —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è 3: –î–∏–∫—Ç–∞–Ω—Ç */
        .exercise3-screen {
            padding: 20px 15px;
            overflow-y: auto;
        }

        .dictation-title {
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.2rem;
            color: var(--dark);
        }

        .dictation-card {
            background: var(--light);
            border-radius: var(--border-radius);
            padding: 22px 18px;
            border: 2px solid var(--light-gray);
            text-align: center;
            margin-bottom: 18px;
        }

        .dictation-prompt-row {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .dictation-prompt {
            font-size: 1.7rem;
            font-weight: 800;
            color: var(--dark);
            word-break: break-word;
        }

        .dictation-input {
            width: 100%;
            padding: 14px 14px;
            border-radius: var(--border-radius);
            border: 2px solid var(--light-gray);
            background: white;
            font-size: 1rem;
            outline: none;
            transition: var(--transition);
            text-align: center;
        }

        .dictation-input:focus {
            border-color: var(--secondary);
            box-shadow: 0 4px 14px rgba(28, 176, 246, 0.15);
        }

        .dictation-actions {
            display: flex;
            gap: 10px;
            margin-top: 12px;
        }

        .dictation-btn {
            flex: 1;
            padding: 14px 12px;
            border-radius: var(--border-radius);
            border: none;
            cursor: pointer;
            font-weight: 800;
            font-size: 0.95rem;
            transition: var(--transition);
            touch-action: manipulation;
        }

/* –°—Ç–∏–ª–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø–æ–¥—Å–∫–∞–∑–∫–∏ */
        #hint-progress-display {
            font-family: monospace;
            font-weight: bold;
            padding: 8px 12px;
            background: rgba(88, 204, 2, 0.1);
            border-radius: 8px;
            color: var(--primary-dark);
        }
        
        .dictation-extra-hint {
            margin-top: 10px;
            padding: 12px 16px;
            border-radius: 12px;
            background: rgba(28, 176, 246, 0.08);
            border: 1px dashed rgba(28, 176, 246, 0.45);
            color: var(--dark);
            font-weight: 700;
            min-height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* –ö–Ω–æ–ø–∫–∞ –ø–æ–¥—Å–∫–∞–∑–∫–∏ –≤—Å–µ–≥–¥–∞ –∞–∫—Ç–∏–≤–Ω–∞ */
        .dictation-hint-btn {
            opacity: 1 !important;
        }

        .dictation-btn-check {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
        }

        .dictation-btn-check:active {
            transform: scale(0.98);
        }

        .dictation-hint {
            color: var(--gray);
            font-size: 0.9rem;
            margin-top: 10px;
            font-style: italic;
        }

        .dictation-metrics {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px 10px;
            margin-top: 12px;
            margin-bottom: 10px;
        }
        .dictation-metric {
            background: rgba(0, 0, 0, 0.03);
            border: 1px solid var(--light-gray);
            border-radius: 12px;
            padding: 8px 10px;
            display: flex;
            align-items: baseline;
            justify-content: space-between;
            gap: 10px;
        }
        body[data-theme="dark"] .dictation-metric {
            background: rgba(255, 255, 255, 0.05);
            border-color: #3f3f46;
        }
        .dictation-metric-label {
            font-size: 0.72rem;
            color: var(--gray);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.04em;
        }
        .dictation-metric-value {
            font-size: 0.95rem;
            font-weight: 900;
            color: var(--dark);
        }
        .dictation-extra-hint {
            margin-top: 10px;
            padding: 10px 12px;
            border-radius: 12px;
            background: rgba(28, 176, 246, 0.08);
            border: 1px dashed rgba(28, 176, 246, 0.45);
            color: var(--dark);
            font-weight: 700;
        }
        .dictation-hints {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 12px;
        }
        .dictation-hint-btn {
            padding: 12px 10px;
            border-radius: var(--border-radius);
            border: 2px solid var(--light-gray);
            background: white;
            cursor: pointer;
            font-weight: 800;
            font-size: 0.9rem;
            transition: var(--transition);
            touch-action: manipulation;
        }
        .dictation-hint-btn:active {
            transform: scale(0.98);
        }
        .dictation-hint-btn[disabled] {
            opacity: 0.6;
            cursor: default;
        }
        .dictation-hint-btn:last-child {
            grid-column: 1 / -1;
        }
        .dictation-btn-next {
            background: #fff;
            color: var(--dark);
            border: 2px solid var(--light-gray);
        }
        body[data-theme="dark"] .dictation-btn-next {
            background: #252529;
            border-color: #3f3f46;
            color: var(--dark);
        }
        .dictation-btn:disabled, .dictation-hint-btn:disabled {
            opacity: 0.6;
            cursor: default;
            transform: none;
        }
        .feedback.typo {
            background: rgba(255, 149, 0, 0.12);
            color: var(--warning);
        }

        /* –¢—ë–º–Ω–∞—è —Ç–µ–º–∞ –¥–ª—è –¥–∏–∫—Ç–∞–Ω—Ç–∞ */
        body[data-theme="dark"] .dictation-card,
        body[data-theme="dark"] .dictation-input {
            background: #252529;
            border-color: #3f3f46;
            color: var(--dark);
        }

        body[data-theme="dark"] .dictation-input:focus {
            border-color: var(--secondary);
            box-shadow: 0 4px 14px rgba(13, 90, 135, 0.25);
        }
        
        /* –≠–∫—Ä–∞–Ω –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤—Å–µ—Ö —Å–ª–æ–≤ */
        .words-list-screen {
            padding: 15px;
            overflow-y: auto;
        }
        
        .words-list-title {
            font-size: 1.4rem;
            margin-bottom: 20px;
            color: var(--dark);
            text-align: center;
        }
        
        .words-list-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .word-list-item {
            background: white;
            border-radius: var(--border-radius);
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid var(--light-gray);
            transition: var(--transition);
            cursor: pointer;
        }
        
        @media (hover: hover) {
            .word-list-item:hover {
                transform: translateY(-2px);
                box-shadow: var(--shadow);
                border-color: var(--secondary);
            }
        }
        .word-list-item:active {
            transform: scale(0.98);
        }
        
        .word-list-text {
            flex: 1;
        }
        
        .word-list-slovak {
            font-weight: bold;
            font-size: 1.1rem;
            color: var(--dark);
            margin-bottom: 4px;
        }
        
        .word-list-russian {
            font-size: 0.95rem;
            color: var(--gray);
        }
        
        .word-list-sound {
            width: 36px;
            height: 36px;
            background: var(--secondary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.9rem;
            cursor: pointer;
            transition: var(--transition);
            flex-shrink: 0;
            margin-left: 10px;
        }
        
        .word-list-sound:hover {
            background: var(--primary);
            transform: scale(1.1);
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è */
        .completion-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }
        
        .completion-content {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            text-align: center;
            max-width: 400px;
            width: 100%;
            animation: fadeIn 0.3s ease;
        }
        
        .completion-icon {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 15px;
        }
        
        .completion-title {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: var(--dark);
        }
        
        .completion-text {
            color: var(--gray);
            margin-bottom: 20px;
            line-height: 1.4;
        }
        
        .completion-buttons {
            display: flex;
            gap: 10px;
        }
        
        .completion-btn {
            flex: 1;
            padding: 12px;
            border-radius: var(--border-radius);
            border: none;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .completion-btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .completion-btn-secondary {
            background: var(--light-gray);
            color: var(--dark);
        }
        
        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes correctPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        @keyframes wrongShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .correct-animation {
            animation: correctPulse 0.3s ease;
        }
        
        .wrong-animation {
            animation: wrongShake 0.5s ease;
        }
        
        /* –¢—ë–º–Ω–∞—è —Ç–µ–º–∞ */
        body[data-theme="dark"] {
            --light: #1a1a1e;
            --dark: #e4e4e7;
            --gray: #a1a1aa;
            --light-gray: #2d2d32;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.35);
            --primary: #3d8c02;
            --primary-dark: #2d6b01;
            --secondary: #0d5a87;
            --danger: #b91c1c;
        }
        body[data-theme="dark"] .app-container {
            background: var(--light);
            box-shadow: none;
        }
        body[data-theme="dark"] .app-header {
            background: linear-gradient(to right, #2d6b01, #0d5a87);
        }
        body[data-theme="dark"] .progress-fill {
            background: linear-gradient(to right, var(--primary), var(--secondary));
        }
        body[data-theme="dark"] .topic-progress-fill {
            background: var(--primary);
        }
        body[data-theme="dark"] .topics-title,
        body[data-theme="dark"] .topics-subtitle,
        body[data-theme="dark"] .topic-info h3,
        body[data-theme="dark"] .topic-info p,
        body[data-theme="dark"] .main-title,
        body[data-theme="dark"] .main-subtitle,
        body[data-theme="dark"] .exercise-info h3,
        body[data-theme="dark"] .exercise-info p,
        body[data-theme="dark"] .stat-value,
        body[data-theme="dark"] .stat-label,
        body[data-theme="dark"] .word-sl,
        body[data-theme="dark"] .word-ru,
        body[data-theme="dark"] .matching-title {
            color: var(--dark);
        }
        body[data-theme="dark"] .topic-stats,
        body[data-theme="dark"] .progress-text {
            color: var(--gray);
        }
        body[data-theme="dark"] .topic-card,
        body[data-theme="dark"] .exercise-card,
        body[data-theme="dark"] .stat-item,
        body[data-theme="dark"] .word-card,
         body[data-theme="dark"] .dictation-card,
        body[data-theme="dark"] .option-btn,
        body[data-theme="dark"] .word-item,
        body[data-theme="dark"] .progress-container,
        body[data-theme="dark"] .language-option:not(.active) {
            background: #252529;
            border-color: #3f3f46;
        }
         body[data-theme="dark"] .dictation-input {
             background: #252529;
             border-color: #3f3f46;
             color: var(--dark);
         }
        body[data-theme="dark"] .option-btn.correct {
            background: #2d6b01;
            color: #e4e4e7;
            border-color: #2d6b01;
        }
        body[data-theme="dark"] .option-btn.wrong {
            background: #7f1d1d;
            color: #fecaca;
            border-color: #7f1d1d;
        }
        body[data-theme="dark"] .feedback.correct {
            background: rgba(45, 107, 1, 0.35);
            color: #86efac;
        }
        body[data-theme="dark"] .feedback.wrong {
            background: rgba(127, 29, 29, 0.5);
            color: #fecaca;
        }
        body[data-theme="dark"] .word-item.matched {
            background: #2d6b01;
            color: #e4e4e7;
            border-color: #2d6b01;
        }
        body[data-theme="dark"] .word-item.wrong {
            background: #7f1d1d;
            color: #fecaca;
            border-color: #7f1d1d;
        }
        body[data-theme="dark"] .word-item.selected { background: rgba(255, 149, 0, 0.2); border-color: var(--warning); }
        body[data-theme="dark"] .option-btn:not(.correct):not(.wrong) { background: #252529; color: var(--dark); }
        body[data-theme="dark"] .language-option.active {
            background: linear-gradient(to right, #2d6b01, #0d5a87);
        }
        body[data-theme="dark"] .pronunciation-btn,
        body[data-theme="dark"] .sound-icon,
        body[data-theme="dark"] .word-list-sound {
            background: var(--secondary);
        }
        body[data-theme="dark"] .word-list-item {
            background: #252529;
            border-color: #3f3f46;
        }
        body[data-theme="dark"] .completion-content {
            background: #252529;
            color: var(--dark);
        }
    </style>
</head>
<body class="no-select" id="appBody">
    <div class="app-container">
        <!-- Header -->
        <div class="app-header header--left" id="appHeader">
            <button class="back-btn" id="backBtn" style="visibility: hidden;">
                <i class="fas fa-arrow-left"></i>
            </button>
            <div class="logo">
                <i class="fas fa-language"></i>
                <span id="headerTitle">Slovak Trainer</span>
            </div>
            <div class="header-actions">
                <button class="sound-btn theme-toggle-btn" id="themeToggleBtn" title="–¢—ë–º–Ω–∞—è / —Å–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞" aria-label="–¢–µ–º–∞">
                    <i class="fas fa-moon" id="themeIcon"></i>
                </button>
                <button class="sound-btn" id="soundToggleBtn" title="–í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –æ–∑–≤—É—á–∫—É">
                    <i class="fas fa-volume-up"></i>
                </button>
                <button class="reset-btn" id="resetBtn" title="–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å" style="display: none;">
                    <i class="fas fa-redo"></i>
                </button>
                <div class="header-spacer" style="width: 36px;"></div>
            </div>
        </div>
        
        <!-- Progress bar -->
        <div class="progress-container" id="progressContainer" style="display: none;">
            <div class="progress-text">
                <span id="progressText">–ü—Ä–æ–≥—Ä–µ—Å—Å: 0%</span>
                <span id="wordsCount">–°–ª–æ–≤: 0/0</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>
        
        <!-- –≠–∫—Ä–∞–Ω –≤—ã–±–æ—Ä–∞ —Ç–µ–º—ã -->
        <div class="screen topics-screen active" id="topicsScreen">
            <h1 class="topics-title">–¢–µ–º—ã</h1>
            <p class="topics-subtitle">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º—É –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –∏–ª–∏ —Ç—Ä–µ–Ω–∏—Ä—É–π—Ç–µ –≤—Å–µ —Å–ª–æ–≤–∞ —Å—Ä–∞–∑—É</p>
            
            <button class="all-words-btn" id="allWordsBtn">
                <span class="all-words-btn-row">
                    <span class="all-words-btn-emoji">üìö</span>
                    <span class="all-words-btn-text">–í—Å–µ —Å–ª–æ–≤–∞ —Å—Ä–∞–∑—É</span>
                    <span class="all-words-btn-count" id="allWordsCount"></span>
                </span>
                <span class="all-words-btn-progress-wrap">
                    <span class="all-words-btn-progress-bar">
                        <span class="all-words-btn-progress-fill" id="allWordsProgressFill"></span>
                    </span>
                    <span class="all-words-btn-progress-text" id="allWordsProgressText"></span>
                </span>
            </button>
            
            <div class="topics-list" id="topicsList">
                <!-- –¢–µ–º—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>
        
        <!-- –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π -->
        <div class="screen main-screen" id="mainScreen">
            <div>
                <div style="text-align: center; margin-bottom: 20px;">
                    <h3 style="color: var(--dark); margin-bottom: 5px;">–í—ã–±–µ—Ä–∏—Ç–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ</h3>
                    <p style="color: var(--gray); font-size: 0.9rem;">–î–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ —Å–ª–æ–≤ –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ç–µ–º—ã</p>
                </div>
                
                <div class="exercise-cards">
                    <div class="exercise-card" id="exercise1Card">
                        <div class="exercise-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="exercise-info">
                            <h3>–í—ã–±–æ—Ä –ø–µ—Ä–µ–≤–æ–¥–∞</h3>
                            <p>–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥ —Å–ª–æ–≤–∞ –∏–∑ 4 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤</p>
                        </div>
                    </div>
                    
                    <div class="exercise-card" id="exercise2Card">
                        <div class="exercise-icon">
                            <i class="fas fa-exchange-alt"></i>
                        </div>
                        <div class="exercise-info">
                            <h3>–°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–ª–æ–≤</h3>
                            <p>–°–æ–µ–¥–∏–Ω–∏—Ç–µ —Å–ª–æ–≤–∞ –Ω–∞ —Ä—É—Å—Å–∫–æ–º –∏ —Å–ª–æ–≤–∞—Ü–∫–æ–º —è–∑—ã–∫–∞—Ö</p>
                        </div>
                    </div>

                    <div class="exercise-card" id="exercise3Card">
                        <div class="exercise-icon">
                            <i class="fas fa-pen"></i>
                        </div>
                        <div class="exercise-info">
                            <h3>–î–∏–∫—Ç–∞–Ω—Ç</h3>
                            <p>–ù–∞–ø–∏—à–∏—Ç–µ –ø–µ—Ä–µ–≤–æ–¥ —Å–ª–æ–≤–∞ (–¥–æ–ø—É—Å–∫–∞—é—Ç—Å—è –Ω–µ–±–æ–ª—å—à–∏–µ –æ–ø–µ—á–∞—Ç–∫–∏)</p>
                        </div>
                    </div>
                </div>
                
                <!-- –ö–Ω–æ–ø–∫–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤—Å–µ—Ö —Å–ª–æ–≤ -->
                <button class="view-words-btn" id="viewWordsBtn">
                    <i class="fas fa-list"></i>
                    –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ —Å–ª–æ–≤–∞
                </button>
                
                <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π –Ω–∞ —ç–∫—Ä–∞–Ω–µ —Ç–µ–º—ã -->
                <div class="theme-action-buttons">
                    <button type="button" class="theme-action-btn theme-action-btn--repeat" id="repeatMistakesBtn">
                        <span class="theme-action-btn-icon"><i class="fas fa-redo"></i></span>
                        <span class="theme-action-btn-text">–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –æ—à–∏–±–∫–∏</span>
                        <span class="theme-action-btn-count" id="repeatMistakesCount">(0)</span>
                    </button>
                    <button type="button" class="theme-action-btn theme-action-btn--reset" id="resetTopicBtn">
                        <span class="theme-action-btn-icon"><i class="fas fa-eraser"></i></span>
                        <span class="theme-action-btn-text">–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å —Ç–µ–º—ã</span>
                    </button>
                </div>
            </div>
            
            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="totalLearned">0</div>
                    <div class="stat-label">–í—ã—É—á–µ–Ω–æ —Å–ª–æ–≤</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="totalAccuracy">0%</div>
                    <div class="stat-label">–¢–æ—á–Ω–æ—Å—Ç—å</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="mistakesCount">0</div>
                    <div class="stat-label">–° –æ—à–∏–±–∫–∞–º–∏</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="wordsInTopic">0</div>
                    <div class="stat-label">–í—Å–µ–≥–æ –≤ —Ç–µ–º–µ</div>
                </div>
            </div>
        </div>
        
        <!-- –≠–∫—Ä–∞–Ω —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è 1: –í—ã–±–æ—Ä –ø–µ—Ä–µ–≤–æ–¥–∞ -->
        <div class="screen exercise1-screen" id="exercise1Screen">
            <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —è–∑—ã–∫–∞ -->
            <div class="language-switcher" id="languageSwitcher">
                <div class="language-option active" id="optionSKtoRU" data-direction="sk-ru">
                    <span class="language-flag">üá∏üá∞</span> ‚Üí <span class="language-flag" id="flagSKtoRU">üá∑üá∫</span>
                    <div id="labelSKtoRU" style="font-size: 0.8rem; margin-top: 2px;">–°–ª–æ–≤–∞—Ü–∫–∏–π ‚Üí –†—É—Å—Å–∫–∏–π</div>
                </div>
                <div class="language-option" id="optionRUtoSK" data-direction="ru-sk">
                    <span class="language-flag" id="flagRUtoSK">üá∑üá∫</span> ‚Üí <span class="language-flag">üá∏üá∞</span>
                    <div id="labelRUtoSK" style="font-size: 0.8rem; margin-top: 2px;">–†—É—Å—Å–∫–∏–π ‚Üí –°–ª–æ–≤–∞—Ü–∫–∏–π</div>
                </div>
            </div>
            
            <div class="word-card">
                <div class="word-header">
                    <div class="word-sl" id="currentWord">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                    <div class="word-ru" id="currentRussianWord" style="display: none;">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                    <button class="pronunciation-btn" id="pronunciationBtn">
                        <i class="fas fa-volume-up"></i>
                    </button>
                </div>
                <div class="pronunciation" id="currentPronunciation">...</div>
                <div class="direction-hint" id="directionHint">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥ —Å–ª–æ–≤–∞</div>
            </div>
            
            <div class="options-container" id="optionsContainer">
                <!-- –í–∞—Ä–∏–∞–Ω—Ç—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
            </div>
            
            <div class="feedback correct" id="correctFeedback">
                <i class="fas fa-check-circle"></i> –í–µ—Ä–Ω–æ! –ü–µ—Ä–µ—Ö–æ–¥–∏–º –¥–∞–ª—å—à–µ
            </div>
            
            <div class="feedback wrong" id="wrongFeedback">
                <i class="fas fa-times-circle"></i> –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: <span id="correctAnswerText">...</span>
            </div>
        </div>
        
        <!-- –≠–∫—Ä–∞–Ω —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è 2: –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–ª–æ–≤ -->
        <div class="screen exercise2-screen" id="exercise2Screen">
            <h3 class="matching-title">–°–æ–ø–æ—Å—Ç–∞–≤—å—Ç–µ —Å–ª–æ–≤–∞</h3>
            
            <div class="matching-container">
                <div class="words-columns-wrapper">
                    <div class="words-column" id="russianWords">
                        <!-- –°–ª–æ–≤–∞ –Ω–∞ —Ä—É—Å—Å–∫–æ–º -->
                    </div>
                    
                    <div class="words-column" id="slovakWords">
                        <!-- –°–ª–æ–≤–∞ –Ω–∞ —Å–ª–æ–≤–∞—Ü–∫–æ–º -->
                    </div>
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è 3: –î–∏–∫—Ç–∞–Ω—Ç -->
        <div class="screen exercise3-screen" id="exercise3Screen">
            <h3 class="dictation-title">–î–∏–∫—Ç–∞–Ω—Ç</h3>

            <div class="language-switcher" id="dictationLanguageSwitcher">
                <div class="language-option" id="dictationOptionRUtoSK">
                    <span class="language-flag">üá∑üá∫</span> –†—É—Å ‚Üí üá∏üá∞ –°–ª–æ–≤–∞—Ü–∫–∏–π
                </div>
                <div class="language-option" id="dictationOptionSKtoRU">
                    <span class="language-flag">üá∏üá∞</span> –°–ª–æ–≤–∞—Ü–∫–∏–π ‚Üí üá∑üá∫ –†—É—Å
                </div>
            </div>

            <div class="dictation-card">
                <div class="dictation-prompt-row">
                    <div class="dictation-prompt" id="dictationPrompt">‚Äî</div>
                    <button class="pronunciation-btn" id="dictationSpeakBtn" type="button" title="–û–∑–≤—É—á–∏—Ç—å">
                        <i class="fas fa-volume-up"></i>
                    </button>
                </div>

                <div class="dictation-hint" id="dictationHint">–í–≤–µ–¥–∏—Ç–µ –ø–µ—Ä–µ–≤–æ–¥</div>


                <div class="dictation-extra-hint" id="dictationExtraHint" style="display:none"></div>

                <input class="dictation-input" id="dictationInput" type="text" autocomplete="off" autocapitalize="none" spellcheck="false" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –æ—Ç–≤–µ—Ç" />

                <div class="dictation-hints">
                    <button class="dictation-hint-btn" id="dictationHintFirstBtn" type="button">–ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
                </div>

                <div class="dictation-actions">
                    <button class="dictation-btn dictation-btn-check" id="dictationCheckBtn" type="button" disabled>
                        –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
                    </button>
                </div>

                <div class="feedback correct" id="dictationCorrectFeedback">
                    <i class="fas fa-check-circle"></i> –¢–æ—á–Ω–æ! ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ: <span id="dictationCorrectAnswerText">...</span>
                </div>

                <div class="feedback typo" id="dictationTypoFeedback">
                    <i class="fas fa-exclamation-triangle"></i> –ü–æ—á—Ç–∏! ‚ö†Ô∏è –ü—Ä–∞–≤–∏–ª—å–Ω–æ: <span id="dictationTypoAnswerText">...</span>
                </div>

                <div class="feedback wrong" id="dictationWrongFeedback">
                    <i class="fas fa-times-circle"></i> –ù–µ–≤–µ—Ä–Ω–æ ‚ùå –ü—Ä–∞–≤–∏–ª—å–Ω–æ: <span id="dictationCorrectAnswerTextWrong">...</span>
                </div>

            </div>
        </div>
        
        <!-- –≠–∫—Ä–∞–Ω –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤—Å–µ—Ö —Å–ª–æ–≤ -->
        <div class="screen words-list-screen" id="wordsListScreen">
            <h2 class="words-list-title" id="wordsListTitle">–°–ª–æ–≤–∞</h2>
            <div class="words-list-container" id="wordsListContainer">
                <!-- –°–ª–æ–≤–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>
        
    </div>

    <script>
        // –î–∞–Ω–Ω—ã–µ —Ç–µ–º
        const topicsData = {
            "all": {
                id: "all",
                name: "–í—Å–µ —Å–ª–æ–≤–∞",
                icon: "fas fa-globe",
                description: "–í—Å–µ —Å–ª–æ–≤–∞ –∏–∑ –≤—Å–µ—Ö —Ç–µ–º",
                words: []
            },
            "topic1": {
                id: "topic1",
                name: "–¢–µ–º–∞ 1 - –ü–µ—Ä–≤—ã–µ —Ñ—Ä–∞–∑—ã –∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è",
                icon: "fas fa-comments",
                description: "–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—Ä–∞–∑—ã –∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –æ–±—â–µ–Ω–∏—è",
                words: [
                    {sk: "Ako sa c√≠tite?", ru: "–ö–∞–∫ –≤—ã —Å–µ–±—è —á—É–≤—Å—Ç–≤—É–µ—Ç–µ?"},
                    {sk: "V≈°etko najlep≈°ie", ru: "–í—Å–µ–≥–æ —Ö–æ—Ä–æ—à–µ–≥–æ"},
                    {sk: "Te≈°√≠m sa na stretnutie", ru: "–î–æ –≤—Å—Ç—Ä–µ—á–∏"},
                    {sk: "Ako sa m√°≈°?", ru: "–ö–∞–∫ –¥–µ–ª–∞?"},
                    {sk: "Poƒç√∫va≈•", ru: "–°–ª—É—à–∞—Ç—å"},
                    {sk: "Pozera≈•", ru: "–°–º–æ—Ç—Ä–µ—Ç—å"},
                    {sk: "Zopakova≈•", ru: "–ü–æ–≤—Ç–æ—Ä—è—Ç—å"},
                    {sk: "Nepochopila som", ru: "–Ø –Ω–µ –ø–æ–Ω—è–ª–∞"},
                    {sk: "Kde b√Ωva≈°?", ru: "–ì–¥–µ —Ç—ã –∂–∏–≤–µ—à—å?"},
                    {sk: "Odkiaƒæ si?", ru: "–û—Ç–∫—É–¥–∞ —Ç—ã?"},
                    {sk: "≈†≈•astn√∫ cestu", ru: "–°—á–∞—Å—Ç–ª–∏–≤–æ–≥–æ –ø—É—Ç–∏"},
                    {sk: "Nech sa p√°ƒçi", ru: "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞"},
                    {sk: "Prep√°ƒçte", ru: "–ò–∑–≤–∏–Ω–∏—Ç–µ"},
                    {sk: "Koƒæko m√°≈° rokov?", ru: "–°–∫–æ–ª—å–∫–æ —Ç–µ–±–µ –ª–µ—Ç?"},
                    {sk: "Dobr√∫ chu≈•", ru: "–ü—Ä–∏—è—Ç–Ω–æ–≥–æ –∞–ø–ø–µ—Ç–∏—Ç–∞"},
                    {sk: "Ako sa vol√°≈°?", ru: "–ö–∞–∫ —Ç–µ–±—è –∑–æ–≤—É—Ç?"},
                    {sk: "Pekn√Ω de≈à", ru: "–•–æ—Ä–æ—à–µ–≥–æ –¥–Ω—è"},
                    {sk: "√Åno / nie", ru: "–î–∞ / –Ω–µ—Ç"},
                    {sk: "Na zdravie", ru: "–ë—É–¥—å –∑–¥–æ—Ä–æ–≤"},
                    {sk: "Hodina", ru: "–£—Ä–æ–∫"}
                ]
            },
            "topic2": {
                id: "topic2",
                name: "–¢–µ–º–∞ 2 - Kde som, ste?",
                icon: "fas fa-map-marker-alt",
                description: "–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è",
                words: [
                    {sk: "na n√°v≈°teve", ru: "–≤ –≥–æ—Å—Ç—è—Ö"},
                    {sk: "v obchode", ru: "–≤ –º–∞–≥–∞–∑–∏–Ω–µ"},
                    {sk: "na prech√°dzke", ru: "–Ω–∞ –ø—Ä–æ–≥—É–ª–∫–µ"},
                    {sk: "doma", ru: "–¥–æ–º–∞"},
                    {sk: "mimo/vonku", ru: "–º–∏–º–æ/–≥–¥–µ-—Ç–æ –Ω–µ –¥–æ–º–∞"},
                    {sk: "na z√°chode", ru: "–≤ —Ç—É–∞–ª–µ—Ç–µ"},
                    {sk: "na slu≈æobnej ceste", ru: "–≤ –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–µ"},
                    {sk: "v kami√≥ne", ru: "–≤ —Ñ—É—Ä–µ"},
                    {sk: "na prest√°vke", ru: "–Ω–∞ –ø–µ—Ä–µ—Ä—ã–≤–µ"},
                    {sk: "v aute", ru: "–≤ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ"},
                    {sk: "na dovolenke", ru: "–≤ –æ—Ç–ø—É—Å–∫–µ"},
                    {sk: "na turistike", ru: "–≤ –ø–æ—Ö–æ–¥–µ –≤ –≥–æ—Ä—ã"},
                    {sk: "na porade", ru: "–Ω–∞ —Å–æ–≤–µ—â–∞–Ω–∏–∏"},
                    {sk: "by≈• chor√Ω", ru: "–±—ã—Ç—å –±–æ–ª—å–Ω—ã–º"},
                    {sk: "by≈• zdrav√Ω", ru: "–±—ã—Ç—å –∑–¥–æ—Ä–æ–≤—ã–º"},
                    {sk: "by≈• ≈æenat√Ω/vydat√°", ru: "–±—ã—Ç—å –∂–µ–Ω–∞—Ç—ã–º/–∑–∞–º—É–∂–µ–º"},
                    {sk: "by≈• unaven√Ω", ru: "–±—ã—Ç—å —É—Å—Ç–∞–≤—à–∏–º"},
                    {sk: "by≈• r√°d", ru: "–±—ã—Ç—å –¥–æ–≤–æ–ª—å–Ω—ã–º"},
                    {sk: "by≈• sm√§dn√Ω", ru: "—Ö–æ—Ç–µ—Ç—å –ø–∏—Ç—å"},
                    {sk: "by≈• hladn√Ω", ru: "–±—ã—Ç—å –≥–æ–ª–æ–¥–Ω—ã–º"},
                    {sk: "by≈• si ist√Ω", ru: "–±—ã—Ç—å —É–≤–µ—Ä–µ–Ω–Ω—ã–º"}
                ]
            },
            "topic3": {
                id: "topic3",
                name: "–¢–µ–º–∞ 3 - –ê1",
                icon: "fas fa-book",
                description: "–ë–∞–∑–æ–≤—ã–µ —Ç–µ—Ä–º–∏–Ω—ã —É—Ä–æ–≤–Ω—è –ê1",
                words: [
                    {sk: "Cez v√≠kend", ru: "–ù–∞ –≤—ã—Ö–æ–¥–Ω—ã—Ö"},
                    {sk: "Nemocnica", ru: "–ë–æ–ª—å–Ω–∏—Ü–∞"},
                    {sk: "Kancel√°ria", ru: "–û—Ñ–∏—Å"},
                    {sk: "Ra≈àajkova≈•", ru: "–ó–∞–≤—Ç—Ä–∞–∫–∞—Ç—å"},
                    {sk: "Skoro", ru: "–†–∞–Ω–æ"},
                    {sk: "Rano", ru: "–£—Ç—Ä–æ–º"},
                    {sk: "A", ru: "–ò"},
                    {sk: "Alebo", ru: "–ò–ª–∏"},
                    {sk: "Rodina", ru: "–°–µ–º—å—è"},
                    {sk: "Niekedy", ru: "–ò–Ω–æ–≥–¥–∞"},
                    {sk: "Nikdy", ru: "–ù–∏–∫–æ–≥–¥–∞"},
                    {sk: "Kamar√°t", ru: "–î—Ä—É–≥"},
                    {sk: "Bicykel", ru: "–í–µ–ª–æ—Å–∏–ø–µ–¥"},
                    {sk: "Hudba", ru: "–ú—É–∑—ã–∫–∞"},
                    {sk: "Jar", ru: "–í–µ—Å–Ω–∞"},
                    {sk: "B√Ωva≈•", ru: "–ü—Ä–æ–∂–∏–≤–∞—Ç—å"},
                    {sk: "Veƒæa", ru: "–ú–Ω–æ–≥–æ"},
                    {sk: "Obchod", ru: "–ú–∞–≥–∞–∑–∏–Ω"},
                    {sk: "dedina", ru: "–°–µ–ª–æ"},
                    {sk: "Byt", ru: "–ö–≤–∞—Ä—Ç–∏—Ä–∞"},
                    {sk: "Izba", ru: "–ö–æ–º–Ω–∞—Ç–∞"},
                    {sk: "Ob√Ωvaƒçka", ru: "–ì–æ—Å—Ç–∏–Ω–∞—è"},
                    {sk: "Kuch√Ω≈àa", ru: "–ö—É—Ö–Ω—è"},
                    {sk: "√ötuln√Ω", ru: "–£—é—Ç–Ω—ã–π"},
                    {sk: "M√°m rad", ru: "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è"},
                    {sk: "Chyba", ru: "–û—à–∏–±–∫–∞"},
                    {sk: "Intern√°t", ru: "–û–±—â–µ–∂–∏—Ç–∏–µ"},
                    {sk: "Ako, pros√≠m", ru: "–ö–∞–∫, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞?"},
                    {sk: "Spr√°vne", ru: "–ü—Ä–∞–≤–∏–ª—å–Ω–æ"},
                    {sk: "Zauj√≠mav√©", ru: "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ"},
                    {sk: "Nevad√≠", ru: "–ù–µ–≤–∞–∂–Ω–æ"},
                    {sk: "Kolegy≈àa", ru: "–ö–æ–ª–ª–µ–≥–∞ (–∂–µ–Ω—â–∏–Ω–∞)"},
                    {sk: "Sleƒçna", ru: "–î–µ–≤—É—à–∫–∞"},
                    {sk: "Chlapec", ru: "–ú–∞–ª—å—á–∏–∫"},
                    {sk: "Spolub√Ωvajuci", ru: "–°–æ—Å–µ–¥ –ø–æ –∫–æ–º–Ω–∞—Ç–µ"}
                ]
            },
            "topic4": {
                id: "topic4",
                name: "–¢–µ–º–∞ 4 - Moja rodina",
                icon: "fas fa-users",
                description: "–°–µ–º–µ–π–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –∏ —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∏",
                words: [
                    {sk: "Otec", ru: "–û—Ç–µ—Ü"},
                    {sk: "Teta", ru: "–¢—ë—Ç—è"},
                    {sk: "Vz≈•ah", ru: "–û—Ç–Ω–æ—à–µ–Ω–∏–µ"},
                    {sk: "Jedin√°ƒçik", ru: "–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Ä–µ–±–µ–Ω–æ–∫"},
                    {sk: "pr√≠buzn√Ω", ru: "–†–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫"},
                    {sk: "By≈• zamestnan√Ω", ru: "–ë—ã—Ç—å —Ç—Ä—É–¥–æ—É—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º"},
                    {sk: "str√Ωko, ujo", ru: "–î—è–¥—è"},
                    {sk: "Nemocnica", ru: "–ë–æ–ª—å–Ω–∏—Ü–∞"},
                    {sk: "≈†tudova≈•", ru: "–£—á–∏—Ç—å—Å—è"},
                    {sk: "spoloƒçne, spolu", ru: "–í–º–µ—Å—Ç–µ"},
                    {sk: "tr√°vi≈• voƒæn√Ω ƒças", ru: "–ü—Ä–æ–≤–æ–¥–∏—Ç—å —Å–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è"},
                    {sk: "Oslavova≈•", ru: "–ü—Ä–∞–∑–¥–Ω–æ–≤–∞—Ç—å"},
                    {sk: "podporova≈•", ru: "–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å"},
                    {sk: "ma≈• r√°d", ru: "–õ—é–±–∏—Ç—å"},
                    {sk: "Rodiƒçia", ru: "–†–æ–¥–∏—Ç–µ–ª–∏"},
                    {sk: "Neter", ru: "–ü–ª–µ–º—è–Ω–Ω–∏—Ü–∞"},
                    {sk: "Synovec", ru: "–ü–ª–µ–º—è–Ω–Ω–∏–∫"},
                    {sk: "Bratranec", ru: "–î–≤–æ—é—Ä–æ–¥–Ω—ã–π –±—Ä–∞—Ç"},
                    {sk: "Sesternica", ru: "–î–≤–æ—é—Ä–æ–¥–Ω–∞—è —Å–µ—Å—Ç—Ä–∞"},
                    {sk: "Deti", ru: "–î–µ—Ç–∏"},
                    {sk: "Babka", ru: "–ë–∞–±—É—à–∫–∞"},
                    {sk: "Dedko", ru: "–î–µ–¥—É—à–∫–∞"},
                    {sk: "Man≈æel / man≈æelka", ru: "–ú—É–∂ / –∂–µ–Ω–∞"},
                    {sk: "S√∫rodenec", ru: "–ë—Ä–∞—Ç –∏–ª–∏ —Å–µ—Å—Ç—Ä–∞"},
                    {sk: "dcera", ru: "–î–æ—á—å"}
                ]
            },
            "topic5": {
                id: "topic5",
                name: "–¢–µ–º–∞ 5 - –û—Å–Ω–æ–≤–Ω—ã–µ –≥–ª–∞–≥–æ–ª—ã",
                icon: "fas fa-running",
                description: "–û—Å–Ω–æ–≤–Ω—ã–µ –≥–ª–∞–≥–æ–ª—ã –∏ –¥–µ–π—Å—Ç–≤–∏—è",
                words: [
                    {sk: "menit", ru: "–º–µ–Ω—è—Ç—å"},
                    {sk: "sk√∫sit", ru: "–ø—Ä–æ–±–æ–≤–∞—Ç—å"},
                    {sk: "verit", ru: "–≤–µ—Ä–∏—Ç—å"},
                    {sk: "zachr√°nit", ru: "—Å–ø–∞—Å–∞—Ç—å"},
                    {sk: "vr√°tit sa", ru: "–≤–æ–∑–≤—Ä–∞—â–∞—Ç—å—Å—è"},
                    {sk: "platit", ru: "–ø–ª–∞—Ç–∏—Ç—å"},
                    {sk: "varit", ru: "–≥–æ—Ç–æ–≤–∏—Ç—å"},
                    {sk: "ucit sa", ru: "—É—á–∏—Ç—å—Å—è"},
                    {sk: "studovat", ru: "–∏–∑—É—á–∞—Ç—å"},
                    {sk: "cestovat", ru: "–ø—É—Ç–µ—à–µ—Å—Ç–≤–æ–≤–∞—Ç—å"},
                    {sk: "obedovat", ru: "–æ–±–µ–¥–∞—Ç—å"},
                    {sk: "dakovat", ru: "–±–ª–∞–≥–æ–¥–∞—Ä–∏—Ç—å"},
                    {sk: "venovat", ru: "–ø–æ—Å–≤—è—â–∞—Ç—å"},
                    {sk: "pozdravovat", ru: "–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å"},
                    {sk: "oslavovat", ru: "–ø—Ä–∞–∑–¥–Ω–æ–≤–∞—Ç—å"},
                    {sk: "menovat", ru: "–Ω–∞–∑—ã–≤–∞—Ç—å"},
                    {sk: "existovat", ru: "—Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å"},
                    {sk: "ospravedlnit sa", ru: "–∏–∑–≤–∏–Ω—è—Ç—å—Å—è"},
                    {sk: "zorganizovat", ru: "–æ—Ä–≥–∞–Ω–∏–∑–æ–≤—ã–≤–∞—Ç—å"},
                    {sk: "volat", ru: "–∑–≤–æ–Ω–∏—Ç—å"},
                    {sk: "hladat", ru: "–∏—Å–∫–∞—Ç—å"},
                    {sk: "pl√°vat", ru: "–ø–ª–∞–≤–∞—Ç—å"},
                    {sk: "citat", ru: "—á–∏—Ç–∞—Ç—å"},
                    {sk: "pridat", ru: "–¥–æ–±–∞–≤–ª—è—Ç—å"},
                    {sk: "pom√°hat", ru: "–ø–æ–º–æ–≥–∞—Ç—å"},
                    {sk: "sk√∫sat", ru: "–ø—Ä–æ–±–æ–≤–∞—Ç—å"},
                    {sk: "z√≠skat", ru: "–ø–æ–ª—É—á–∞—Ç—å"},
                    {sk: "objednat", ru: "–∑–∞–∫–∞–∑—ã–≤–∞—Ç—å"},
                    {sk: "h√°dat sa", ru: "—Å–ø–æ—Ä–∏—Ç—å"},
                    {sk: "d√∫fat", ru: "–Ω–∞–¥–µ—è—Ç—å—Å—è"}
                ]
            },
            "topic6": {
                id: "topic6", 
                name: "–¢–µ–º–∞ 6 - Adjekt√≠va + farby",
                icon: "fas fa-palette",
                description: "–ü—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ –∏ –Ω–∞–∑–≤–∞–Ω–∏—è —Ü–≤–µ—Ç–æ–≤",
                words: [
                    {sk: "R√Ωchly", ru: "–±—ã—Å—Ç—Ä—ã–π"},
                    {sk: "Pomal√Ω", ru: "–ú–µ–¥–ª–µ–Ω–Ω—ã–π"},
                    {sk: "≈†kared√Ω", ru: "–°—Ç—Ä–∞—à–Ω—ã–π"},
                    {sk: "Pekn√Ω", ru: "–ö—Ä–∞—Å–∏–≤—ã–π"},
                    {sk: "Prenajat√Ω", ru: "–∞—Ä–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–π"},
                    {sk: "Vlastn√Ω", ru: "—Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π, —Å–≤–æ–π"},
                    {sk: "Vypnut√Ω", ru: "–≤—ã–∫–ª—é—á–µ–Ω–Ω—ã–π"},
                    {sk: "Zapnut√Ω", ru: "–≤–∫–ª—é—á–µ–Ω–Ω—ã–π"},
                    {sk: "Pokazen√Ω", ru: "—Å–ª–æ–º–∞–Ω–Ω—ã–π"},
                    {sk: "Opraven√Ω", ru: "–æ—Ç—Ä–µ–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π"},
                    {sk: "Tuƒçn√Ω", ru: "–¢–æ–ª—Å—Ç—ã–π"},
                    {sk: "Pohodln√Ω", ru: "–£–¥–æ–±–Ω—ã–π"},
                    {sk: "Modern√Ω", ru: "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π"},
                    {sk: "Pr√°zdny", ru: "–ü—É—Å—Ç–æ–π"},
                    {sk: "Chutn√Ω", ru: "–í–∫—É—Å–Ω—ã–π"},
                    {sk: "≈†pinav√Ω", ru: "–ì—Ä—è–∑–Ω—ã–π"},
                    {sk: "Smutn√Ω", ru: "–ì—Ä—É—Å–Ω—ã–π"},
                    {sk: "ƒåerstv√Ω", ru: "–°–≤–µ–∂—ã–π"},
                    {sk: "Zauj√≠mav√Ω", ru: "–∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π"},
                    {sk: "Hl√∫py", ru: "–≥–ª—É–ø—ã–π"},
                    {sk: "Siv√Ω", ru: "–°–µ—Ä—ã–π"},
                    {sk: "Hned√Ω", ru: "–ö–æ—Ä–∏—á–Ω–µ–≤—ã–π"},
                    {sk: "Ru≈æov√Ω", ru: "–†–æ–∑–æ–≤—ã–π"},
                    {sk: "Modr√Ω", ru: "–°–∏–Ω–∏–π"},
                    {sk: "ƒåierny", ru: "–ß—ë—Ä–Ω—ã–π"},
                    {sk: "Nabit√Ω", ru: "–ó–∞—Ä—è–¥–∂–µ–Ω–∏–π"},
                    {sk: "Vybit√Ω", ru: "–†–æ–∑—Ä—è–¥–∂–µ–Ω–∏–π"},
                    {sk: "Zanepr√°zdnen√Ω", ru: "–∑–∞–Ω—è—Ç–æ–π (–ø—Ä–æ –ª—é–¥–∏–Ω—É)"},
                    {sk: "Unaven√Ω", ru: "–í—Ç–æ–º–ª–µ–Ω–∏–π"},
                    {sk: "Lacn√Ω", ru: "–¥–µ—à–µ–≤–∏–π"}
                ]
            },
            "topic7": {
                id: "topic7",
                name: "–¢–µ–º–∞ 7 - –ù–∞–≤–∏–≥–∞—Ü–∏—è –∏ –∑–Ω–∞–∫–∏",
                icon: "fas fa-directions",
                description: "–¢–µ—Ä–º–∏–Ω—ã –Ω–∞–≤–∏–≥–∞—Ü–∏–∏, –∑–Ω–∞–∫–∏ –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å",
                words: [
                    {sk: "≈†ipka (hore)", ru: "–°—Ç—Ä—ñ–ª–∫–∞ (–≤–≥–æ—Ä—É)"},
                    {sk: "≈†ipka (dole)", ru: "–°—Ç—Ä—ñ–ª–∫–∞ (–≤–Ω–∏–∑)"},
                    {sk: "≈†ipka (doƒæava)", ru: "–°—Ç—Ä—ñ–ª–∫–∞ (–≤–ª—ñ–≤–æ)"},
                    {sk: "≈†ipka (doprava)", ru: "–°—Ç—Ä—ñ–ª–∫–∞ (–≤–ø—Ä–∞–≤–æ)"},
                    {sk: "≈†ipka (sp√§≈•)", ru: "–°—Ç—Ä—ñ–ª–∫–∞ (–Ω–∞–∑–∞–¥)"},
                    {sk: "≈†tvorec", ru: "–ö–≤–∞–¥—Ä–∞—Ç"},
                    {sk: "Koleƒçko", ru: "–ö—Ä—É–∂–µ—á–æ–∫"},
                    {sk: "Tlaƒçidlo", ru: "–ö–Ω–æ–ø–∫–∞"},
                    {sk: "Navigaƒçn√© tlaƒçidla", ru: "–ö–Ω–æ–ø–∫–∏ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó"},
                    {sk: "Kr√≠≈æ", ru: "–•—Ä–µ—Å—Ç–∏–∫"},
                    {sk: "Potiahnite prstom", ru: "–ü–æ—Ç—è–≥–Ω—ñ—Ç—å –≤–≥–æ—Ä—É (—Å–≤–∞–π–ø)"},
                    {sk: "Uplne", ru: "–ü–æ–≤–Ω—ñ—Å—Ç—é"},
                    {sk: "Zminimalizova≈•", ru: "–ó–º–µ–Ω—à–∏—Ç–∏"},
                    {sk: "Bodka/teƒçka", ru: "–ö—Ä–∞–ø–∫–∞"},
                    {sk: "In≈°talova≈•", ru: "–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏"},
                    {sk: "Zru≈°i≈•", ru: "–°–∫–∞—Å—É–≤–∞—Ç–∏"},
                    {sk: "Z√≠ska≈•", ru: "–û—Ç—Ä–∏–º–∞—Ç–∏"},
                    {sk: "Odkaz", ru: "–ü–æ—Å–∏–ª–∞–Ω–Ω—è"},
                    {sk: "Spr√°va", ru: "–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è"},
                    {sk: "Medzera", ru: "–ü—Ä–æ–±—ñ–ª"},
                    {sk: "Toƒç√≠ sa krou≈æek?", ru: "–ö—ñ–ª—å—Ü–µ —Ä—É—Ö–∞—î—Ç—å—Å—è?"},
                    {sk: "Pomaly", ru: "–ü–æ–≤—ñ–ª—å–Ω–æ"},
                    {sk: "Pomal≈°ie", ru: "–ü–æ–≤—ñ–ª—å–Ω—ñ—à–µ"},
                    {sk: "V r√Ωchlosti", ru: "–®–≤–∏–¥–∫–æ"},
                    {sk: "Doruƒçen√©", ru: "–û—Ç—Ä–∏–º–∞–Ω–æ"},
                    {sk: "Nevy≈æiadan√° po≈°ta", ru: "–°–ø–∞–º"},
                    {sk: "Vlo≈æi≈•", ru: "–í—Å—Ç–∞–≤–∏—Ç–∏"},
                    {sk: "Prieƒçinok/slo≈æka", ru: "–ü–∞–ø–∫–∞"},
                    {sk: "Odstr√°ni≈•", ru: "–í–∏–¥–∞–ª–∏—Ç–∏"},
                    {sk: "Upravi≈•", ru: "–†–µ–¥–∞–≥—É–≤–∞—Ç–∏"},
                    {sk: "Skontrolova≈•", ru: "–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏"},
                    {sk: "Pe≈àa≈æenka", ru: "–ì–∞–º–∞–Ω–µ—Ü—å"},
                    {sk: "Ozn√°menie", ru: "–°–ø–æ–≤—ñ—â–µ–Ω–Ω—è"},
                    {sk: "V√Ωkriƒçn√≠k", ru: "–ó–Ω–∞–∫ –æ–∫–ª–∏–∫—É"},
                    {sk: "Ot√°znik", ru: "–ó–Ω–∞–∫ –ø–∏—Ç–∞–Ω–Ω–∏—è"},
                    {sk: "Ukƒæudnite sa/budete v kƒæudu", ru: "–ó–∞—Å–ø–æ–∫–æ–π—Ç–µ—Å—å"},
                    {sk: "Zv√§ƒç≈°i≈• (zv√§ƒç≈°√≠te)", ru: "–ó–±—ñ–ª—å—à–∏—Ç–∏"},
                    {sk: "Vyma≈æte (vymaza≈•)", ru: "–í–∏–¥–∞–ª–∏—Ç–∏/–ø—Ä–∏–±—Ä–∞—Ç–∏"},
                    {sk: "Zastavte sa", ru: "–ó—É–ø–∏–Ω—ñ—Ç—å—Å—è"},
                    {sk: "Niƒç neh√Ωbte", ru: "–ù—ñ—á–æ–≥–æ –Ω–µ —Ä—É—Ö–∞–π—Ç–µ"},
                    {sk: "Podr≈æ√≠te (nemus√≠te to podr≈æa≈• ale ƒæahko stlaƒçi≈•)", ru: "–¢—Ä–∏–º–∞—Ç–∏ (–Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ç—Ä–∏–º–∞—Ç–∏ –π–æ–≥–æ, –∞ –ª–∏—à–µ –∑–ª–µ–≥–∫–∞ –Ω–∞—Ç–∏—Å–Ω—É—Ç–∏)"},
                    {sk: "Vratte sa sp√§≈•", ru: "–ü–æ–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –Ω–∞–∑–∞–¥"},
                    {sk: "Odtiaƒæ potiahnite dole", ru: "–ó–≤—ñ–¥—Ç–∏ –ø—Ä–æ–≤–µ–¥—ñ—Ç—å –≤–Ω–∏–∑"},
                    {sk: "V ƒæavom hornom", ru: "–£ –≤–µ—Ä—Ö–Ω—å–æ–º—É –ª—ñ–≤–æ–º—É –∫—É—Ç–∫—É"},
                    {sk: "V ƒæavom doln–æ–º", ru: "–£ –≤–µ—Ä—Ö–Ω—å–æ–º—É –ª—ñ–≤–æ–º—É –∫—É—Ç–∫—É"},
                    {sk: "Obnovte str√°n–∫—É", ru: "–û–Ω–æ–≤—ñ—Ç—å —Å—Ç–æ—Ä—ñ–Ω–∫—É"},
                    {sk: "Vyzer√° ako", ru: "–°—Ö–æ–∂–µ –Ω–∞ —Ç–µ"},
                    {sk: "Doƒæava", ru: "–õ—ñ–≤–æ—Ä—É—á"},
                    {sk: "Doprava", ru: "–ü—Ä–∞–≤–æ—Ä—É—á"},
                    {sk: "Pozrite", ru: "–ü–æ–¥–∏–≤—ñ—Ç—å—Å—è"}
                ]
            },
            "topic8": {
                id: "topic8",
                name: "–¢–µ–º–∞ 8 - Verba",
                icon: "fas fa-edit",
                description: "–°–ª–æ–≤–∞—Ü—å–∫—ñ –¥—ñ—î—Å–ª–æ–≤–∞ –∑ —É–∫—Ä–∞—ó–Ω—Å—å–∫–∏–º –ø–µ—Ä–µ–∫–ª–∞–¥–æ–º",
                words: [
                    {sk: "≈†tudova≈•", ru: "–í—á–∏—Ç–∏—Å—å"},
                    {sk: "Cestova≈•", ru: "–ü–æ–¥–æ—Ä–æ–∂—É–≤–∞—Ç–∏"},
                    {sk: "Menova≈•", ru: "–ù–∞–∑–∏–≤–∞—Ç–∏"},
                    {sk: "Existova≈•", ru: "–Ü—Å–Ω—É–≤–∞—Ç–∏"},
                    {sk: "Ospravedl≈àova≈• sa", ru: "–í–∏–±–∞—á–∞—Ç–∏—Å—å"},
                    {sk: "Venova≈•", ru: "–ü—Ä–∏—Å–≤—è—á—É–≤–∞—Ç–∏"},
                    {sk: "Oslavova≈•", ru: "–°–≤—è—Ç–∫—É–≤–∞—Ç–∏"},
                    {sk: "Zorganizova≈•", ru: "–û—Ä–≥–∞–Ω—ñ–∑–æ–≤—É–≤–∞—Ç–∏"},
                    {sk: "Poƒç√∫va≈•", ru: "–°–ª—É—Ö–∞—Ç–∏"},
                    {sk: "Zopakova≈•", ru: "–ü–æ–≤—Ç–æ—Ä—é–≤–∞—Ç–∏"},
                    {sk: "Prelo≈æi≈•", ru: "–ü–µ—Ä–µ–∫–ª–∞—Å—Ç–∏"},
                    {sk: "Vytvori≈•", ru: "–°—Ç–≤–æ—Ä–∏—Ç–∏"},
                    {sk: "Prech√°dza≈• sa", ru: "–ü—Ä–æ–≥—É–ª—é–≤–∞—Ç–∏—Å—å"},
                    {sk: "Nav≈°tevova≈•", ru: "–ù–∞–≤—ñ–¥—É–≤–∞—Ç–∏"},
                    {sk: "H√°da≈• sa", ru: "–°–≤–∞—Ä–∏—Ç–∏—Å—å"},
                    {sk: "Objedna≈•", ru: "–ó–∞–º–æ–≤–ª—è—Ç–∏"},
                    {sk: "Hƒæada≈•", ru: "–®—É–∫–∞—Ç–∏"},
                    {sk: "Sk√∫≈°a≈•", ru: "–ü—Ä–æ–±—É–≤–∞—Ç–∏"},
                    {sk: "D√∫fa≈•", ru: "–ù–∞–¥—ñ—è—Ç–∏—Å—å"},
                    {sk: "klama≈• (klamem)", ru: "–ë—Ä–µ—Ö–∞—Ç–∏"},
                    {sk: "Rozprava≈•", ru: "–≥–æ–≤–æ—Ä–∏—Ç–∏"},
                    {sk: "pres≈•ahova≈• sa", ru: "–ø–µ—Ä–µ—ó—Ö–∞—Ç–∏"},
                    {sk: "pripravova≈• sa", ru: "–≥–æ—Ç—É–≤–∞—Ç–∏—Å—å"},
                    {sk: "rozhodova≈• sa", ru: "–≤–∏—Ä—ñ—à–∏—Ç–∏"},
                    {sk: "ƒæutova≈•", ru: "–∂–∞–ª–∫—É–≤–∞—Ç–∏"},
                    {sk: "brigadova≈•", ru: "–ø—ñ–¥—Ä–æ–±–ª—è—Ç–∏"}
                ]
            },
            "topic9": {
                id: "topic9",
                name: "–¢–µ–º–∞ 9 - –î—ñ—î—Å–ª–æ–≤–∞ –¥–ª—è —Ä–æ–±–æ—Ç–∏",
                icon: "fas fa-briefcase",
                description: "–°–ª–æ–≤–∞—Ü—å–∫—ñ –¥—ñ—î—Å–ª–æ–≤–∞ –¥–ª—è —Ä–æ–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤ (üá∫üá¶ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞)",
                words: [
                    {sk: "vysvetli≈•", ru: "–ø–æ—è—Å–Ω–∏—Ç–∏"},
                    {sk: "odpoveda≈•", ru: "–≤—ñ–¥–ø–æ–≤—ñ—Å—Ç–∏"},
                    {sk: "poƒç√∫va≈•", ru: "—Å–ª—É—Ö–∞—Ç–∏"},
                    {sk: "p√Ωta≈• sa", ru: "–ø–∏—Ç–∞—Ç–∏"},
                    {sk: "rie≈°i≈•", ru: "–≤–∏—Ä—ñ—à—É–≤–∞—Ç–∏"},
                    {sk: "pon√∫ka≈•", ru: "–ø—Ä–æ–ø–æ–Ω—É–≤–∞—Ç–∏"},
                    {sk: "presvedƒçi≈•", ru: "–ø–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏"},
                    {sk: "objedna≈•", ru: "–∑–∞–º–æ–≤–∏—Ç–∏"},
                    {sk: "z√≠skava≈•", ru: "–æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏"},
                    {sk: "vybavi≈•", ru: "–æ—Ñ–æ—Ä–º–∏—Ç–∏ / –≤–ª–∞–¥–Ω–∞—Ç–∏"},
                    {sk: "vybera≈•", ru: "–∑–Ω—ñ–º–∞—Ç–∏ (–≥—Ä–æ—à—ñ)"},
                    {sk: "in≈°talova≈•", ru: "–≤—Å—Ç–∞–Ω–æ–≤–ª—é–≤–∞—Ç–∏"},
                    {sk: "stiahnu≈•", ru: "–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏"},
                    {sk: "overi≈•", ru: "–ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏"},
                    {sk: "nastavi≈•", ru: "–Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏"},
                    {sk: "pou≈æ√≠va≈•", ru: "–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏"},
                    {sk: "pripoji≈•", ru: "–ø—ñ–¥–∫–ª—é—á–∏—Ç–∏"},
                    {sk: "spravova≈•", ru: "—É–ø—Ä–∞–≤–ª—è—Ç–∏"},
                    {sk: "zabezpeƒçi≈•", ru: "–∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏"},
                    {sk: "sledova≈•", ru: "—Å—Ç–µ–∂–∏—Ç–∏ / —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—Ç–∏"},
                    {sk: "vyhodnoti≈•", ru: "–æ—Ü—ñ–Ω–∏—Ç–∏"},
                    {sk: "prisp√¥sobi≈•", ru: "–∞–¥–∞–ø—Ç—É–≤–∞—Ç–∏ / –ø—ñ–¥–ª–∞—à—Ç—É–≤–∞—Ç–∏"},
                    {sk: "≈°koli≈•", ru: "–Ω–∞–≤—á–∞—Ç–∏ / –ø—Ä–æ–≤–æ–¥–∏—Ç–∏ –Ω–∞–≤—á–∞–Ω–Ω—è"}
                ]
            }
        };

        // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ —Å–ª–æ–≤–∞ –¥–ª—è —Ç–µ–º—ã "–í—Å–µ —Å–ª–æ–≤–∞"
        for (const topicId in topicsData) {
            if (topicId !== "all" && topicsData[topicId].words) {
                topicsData.all.words = [...(topicsData.all.words || []), ...topicsData[topicId].words];
            }
        }

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentTopic = null;
        let currentExercise = null;
        let speechEnabled = localStorage.getItem('slovakSpeechEnabled') !== 'false';
        let exercise1Direction = localStorage.getItem('exercise1Direction') || 'sk-ru';
        let exercise3Direction = localStorage.getItem('exercise3Direction') || 'ru-sk';

        // –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ —Ç–µ–º–∞–º
        let topicStats = JSON.parse(localStorage.getItem('slovakTopicStats')) || {};
        let topicMistakes = JSON.parse(localStorage.getItem('slovakTopicMistakes')) || {};

        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        const topicsScreen = document.getElementById('topicsScreen');
        const mainScreen = document.getElementById('mainScreen');
        const exercise1Screen = document.getElementById('exercise1Screen');
        const exercise2Screen = document.getElementById('exercise2Screen');
        const exercise3Screen = document.getElementById('exercise3Screen');
        const wordsListScreen = document.getElementById('wordsListScreen');
        const backBtn = document.getElementById('backBtn');
        const resetBtn = document.getElementById('resetBtn');
        const resetTopicBtn = document.getElementById('resetTopicBtn');
        const repeatMistakesBtn = document.getElementById('repeatMistakesBtn');
        const viewWordsBtn = document.getElementById('viewWordsBtn');
        const soundToggleBtn = document.getElementById('soundToggleBtn');
        const pronunciationBtn = document.getElementById('pronunciationBtn');
        const exercise1Card = document.getElementById('exercise1Card');
        const exercise2Card = document.getElementById('exercise2Card');
        const exercise3Card = document.getElementById('exercise3Card');
        const allWordsBtn = document.getElementById('allWordsBtn');
        const topicsList = document.getElementById('topicsList');
        const headerTitle = document.getElementById('headerTitle');
        const progressContainer = document.getElementById('progressContainer');
        const progressText = document.getElementById('progressText');
        const wordsCount = document.getElementById('wordsCount');
        const progressFill = document.getElementById('progressFill');
        const totalLearnedEl = document.getElementById('totalLearned');
        const totalAccuracyEl = document.getElementById('totalAccuracy');
        const mistakesCountEl = document.getElementById('mistakesCount');
        const wordsInTopicEl = document.getElementById('wordsInTopic');
        const repeatMistakesCountEl = document.getElementById('repeatMistakesCount');
        const appBody = document.getElementById('appBody');
        const themeToggleBtn = document.getElementById('themeToggleBtn');
        const themeIcon = document.getElementById('themeIcon');
        const wordsListContainer = document.getElementById('wordsListContainer');
        const wordsListTitle = document.getElementById('wordsListTitle');

        // –≠–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è 1
        const languageSwitcher = document.getElementById('languageSwitcher');
        const optionSKtoRU = document.getElementById('optionSKtoRU');
        const optionRUtoSK = document.getElementById('optionRUtoSK');
        const currentWordEl = document.getElementById('currentWord');
        const currentRussianWordEl = document.getElementById('currentRussianWord');
        const currentPronunciationEl = document.getElementById('currentPronunciation');
        const directionHint = document.getElementById('directionHint');
        const optionsContainer = document.getElementById('optionsContainer');
        const correctFeedback = document.getElementById('correctFeedback');
        const wrongFeedback = document.getElementById('wrongFeedback');
        const correctAnswerText = document.getElementById('correctAnswerText');

        // –≠–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è 3 (–¥–∏–∫—Ç–∞–Ω—Ç)
        const dictationLanguageSwitcher = document.getElementById('dictationLanguageSwitcher');
        const dictationOptionRUtoSK = document.getElementById('dictationOptionRUtoSK');
        const dictationOptionSKtoRU = document.getElementById('dictationOptionSKtoRU');
        const dictationPromptEl = document.getElementById('dictationPrompt');
        const dictationHintEl = document.getElementById('dictationHint');
        const dictationInputEl = document.getElementById('dictationInput');
        const dictationCheckBtn = document.getElementById('dictationCheckBtn');
        const dictationSpeakBtn = document.getElementById('dictationSpeakBtn');
        const dictationCorrectFeedback = document.getElementById('dictationCorrectFeedback');
        const dictationWrongFeedback = document.getElementById('dictationWrongFeedback');
        const dictationCorrectAnswerText = document.getElementById('dictationCorrectAnswerText');
        const dictationCorrectAnswerTextWrong = document.getElementById('dictationCorrectAnswerTextWrong');
        const dictationTypoFeedback = document.getElementById('dictationTypoFeedback');
        const dictationTypoAnswerText = document.getElementById('dictationTypoAnswerText');
        const dictationHintFirstBtn = document.getElementById('dictationHintFirstBtn');
        const dictationExtraHintEl = document.getElementById('dictationExtraHint');
        const dictationExactAccuracyEl = document.getElementById('dictationExactAccuracy');
        const dictationWordStreakEl = document.getElementById('dictationWordStreak');
        const dictationLearnedCountEl = document.getElementById('dictationLearnedCount');
        const dictationNextBtn = document.getElementById('dictationNextBtn');
        const dictationRepeatSoundBtn = document.getElementById('dictationRepeatSoundBtn');
        const dictationHintLenBtn = document.getElementById('dictationHintLenBtn');
        const dictationAcceptedAccuracyEl = document.getElementById('dictationAcceptedAccuracy');


        // –≠–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è 2
        const russianWordsEl = document.getElementById('russianWords');
        const slovakWordsEl = document.getElementById('slovakWords');

        function applyTheme(theme) {
            if (!appBody) return;
            appBody.setAttribute('data-theme', theme || 'light');
            if (themeIcon) {
                themeIcon.className = theme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
            }
        }

        function toggleTheme() {
            const current = appBody && appBody.getAttribute('data-theme');
            const next = current === 'dark' ? 'light' : 'dark';
            applyTheme(next);
            localStorage.setItem('slovakTheme', next);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function initApp() {
            const savedTheme = localStorage.getItem('slovakTheme');
            if (savedTheme === 'dark') applyTheme('dark');
            
            initializeTopicStats();
            renderTopics();
            setupEventListeners();
            updateSoundButton();
            setupLanguageSwitcher();
            setupDictationSwitcher();
        }

        function updateLanguageSwitcherLabels() {
            const isTopic7 = currentTopic && currentTopic.id === 'topic7';
            const isTopic8 = currentTopic && currentTopic.id === 'topic8';
            const isTopic9 = currentTopic && currentTopic.id === 'topic9'; // ‚Üê –î–û–î–ê–¢–ò
            
            const flagSKtoRU = document.getElementById('flagSKtoRU');
            const flagRUtoSK = document.getElementById('flagRUtoSK');
            const labelSKtoRU = document.getElementById('labelSKtoRU');
            const labelRUtoSK = document.getElementById('labelRUtoSK');
            
            if (!flagSKtoRU || !flagRUtoSK || !labelSKtoRU || !labelRUtoSK) return;
            
            if (isTopic7 || isTopic8 || isTopic9) { // ‚Üê –î–û–î–ê–¢–ò isTopic9
                flagSKtoRU.textContent = 'üá∫üá¶';
                flagRUtoSK.textContent = 'üá∫üá¶';
                labelSKtoRU.textContent = '–°–ª–æ–≤–∞—Ü—å–∫–∞ ‚Üí –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞';
                labelRUtoSK.textContent = '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ ‚Üí –°–ª–æ–≤–∞—Ü—å–∫–∞';
            } else {
                flagSKtoRU.textContent = 'üá∑üá∫';
                flagRUtoSK.textContent = 'üá∑üá∫';
                labelSKtoRU.textContent = '–°–ª–æ–≤–∞—Ü–∫–∏–π ‚Üí –†—É—Å—Å–∫–∏–π';
                labelRUtoSK.textContent = '–†—É—Å—Å–∫–∏–π ‚Üí –°–ª–æ–≤–∞—Ü–∫–∏–π';
            }
        }

        function setupLanguageSwitcher() {
            if (exercise1Direction === 'sk-ru') {
                optionSKtoRU.classList.add('active');
                optionRUtoSK.classList.remove('active');
            } else {
                optionRUtoSK.classList.add('active');
                optionSKtoRU.classList.remove('active');
            }
            
            optionSKtoRU.addEventListener('click', () => {
                if (exercise1Direction !== 'sk-ru') {
                    exercise1Direction = 'sk-ru';
                    localStorage.setItem('exercise1Direction', 'sk-ru');
                    optionSKtoRU.classList.add('active');
                    optionRUtoSK.classList.remove('active');
                    
                    if (currentExercise === 'exercise1') {
                        startExercise1(exercise1MistakesMode);
                    }
                }
            });
            
            optionRUtoSK.addEventListener('click', () => {
                if (exercise1Direction !== 'ru-sk') {
                    exercise1Direction = 'ru-sk';
                    localStorage.setItem('exercise1Direction', 'ru-sk');
                    optionRUtoSK.classList.add('active');
                    optionSKtoRU.classList.remove('active');
                    
                    if (currentExercise === 'exercise1') {
                        startExercise1(exercise1MistakesMode);
                    }
                }
            });
        }

        function updateDictationLanguageSwitcher() {
            const isTopic7 = currentTopic && currentTopic.id === 'topic7';
            const isTopic8 = currentTopic && currentTopic.id === 'topic8';
            const isTopic9 = currentTopic && currentTopic.id === 'topic9'; // ‚Üê –î–û–î–ê–¢–ò
        
            if (!dictationOptionRUtoSK || !dictationOptionSKtoRU) return;
        
            if (isTopic7 || isTopic8 || isTopic9) { // ‚Üê –î–û–î–ê–¢–ò isTopic9
                dictationOptionRUtoSK.innerHTML = '<span class="language-flag">üá∫üá¶</span> –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ ‚Üí üá∏üá∞ –°–ª–æ–≤–∞—Ü—å–∫–∞';
                dictationOptionSKtoRU.innerHTML = '<span class="language-flag">üá∏üá∞</span> –°–ª–æ–≤–∞—Ü—å–∫–∞ ‚Üí üá∫üá¶ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞';
            } else {
                dictationOptionRUtoSK.innerHTML = '<span class="language-flag">üá∑üá∫</span> –†—É—Å—Å–∫–∏–π ‚Üí üá∏üá∞ –°–ª–æ–≤–∞—Ü–∫–∏–π';
                dictationOptionSKtoRU.innerHTML = '<span class="language-flag">üá∏üá∞</span> –°–ª–æ–≤–∞—Ü–∫–∏–π ‚Üí üá∑üá∫ –†—É—Å—Å–∫–∏–π';
            }
        }

        function setupDictationSwitcher() {
            updateDictationLanguageSwitcher();

            if (exercise3Direction === 'ru-sk') {
                dictationOptionRUtoSK.classList.add('active');
                dictationOptionSKtoRU.classList.remove('active');
            } else {
                dictationOptionSKtoRU.classList.add('active');
                dictationOptionRUtoSK.classList.remove('active');
            }

            dictationOptionRUtoSK.addEventListener('click', () => {
                if (exercise3Direction !== 'ru-sk') {
                    exercise3Direction = 'ru-sk';
                    localStorage.setItem('exercise3Direction', 'ru-sk');
                    dictationOptionRUtoSK.classList.add('active');
                    dictationOptionSKtoRU.classList.remove('active');
                    if (currentExercise === 'exercise3') {
                        startExercise3();
                    }
                }
            });

            dictationOptionSKtoRU.addEventListener('click', () => {
                if (exercise3Direction !== 'sk-ru') {
                    exercise3Direction = 'sk-ru';
                    localStorage.setItem('exercise3Direction', 'sk-ru');
                    dictationOptionSKtoRU.classList.add('active');
                    dictationOptionRUtoSK.classList.remove('active');
                    if (currentExercise === 'exercise3') {
                        startExercise3();
                    }
                }
            });

            if (dictationCheckBtn) {
                dictationCheckBtn.addEventListener('click', () => {
                    if (!dictationCheckBtn.disabled) checkDictationAnswer();
                });
            }
            if (dictationNextBtn) {
                dictationNextBtn.addEventListener('click', () => {
                    dictationGoNextNow();
                });
            }
            if (dictationInputEl) {
                dictationInputEl.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        if (dictationCheckBtn && !dictationCheckBtn.disabled) {
                            checkDictationAnswer();
                        }
                    }
                });
                dictationInputEl.addEventListener('input', () => {
                    updateDictationCheckButtonState();
                });
            }
            if (dictationSpeakBtn) {
                dictationSpeakBtn.addEventListener('click', () => {
                    if (currentExercise3Current) speakWord(currentExercise3Current.sk);
                });
            }
            if (dictationRepeatSoundBtn) {
                dictationRepeatSoundBtn.addEventListener('click', () => {
                    if (currentExercise3Current) speakWord(currentExercise3Current.sk);
                });
            }
            if (dictationHintFirstBtn) {
                dictationHintFirstBtn.addEventListener('click', () => {
                    exercise3UsedHintForCurrent = true;
                    renderDictationHint('first');
                });
            }
            if (dictationHintLenBtn) {
                dictationHintLenBtn.addEventListener('click', () => {
                    exercise3UsedHintForCurrent = true;
                    renderDictationHint('len');
                });
            }
        }

        function initializeTopicStats() {
            for (const topicId in topicsData) {
                if (!topicStats[topicId]) {
                    topicStats[topicId] = {
                        learned: [],
                        exercise1Accuracy: 0,
                        exercise2Accuracy: 0,
                        exercise3Accuracy: 0,
                        exercise1Stats: { correct: 0, total: 0 },
                        exercise2Stats: { correct: 0, total: 0 },
                        exercise3Stats: { correct: 0, total: 0 }
                    };
                } else {
                    if (!Array.isArray(topicStats[topicId].learned)) {
                        topicStats[topicId].learned = [];
                    }
                    if (typeof topicStats[topicId].exercise1Accuracy !== 'number') {
                        topicStats[topicId].exercise1Accuracy = 0;
                    }
                    if (typeof topicStats[topicId].exercise2Accuracy !== 'number') {
                        topicStats[topicId].exercise2Accuracy = 0;
                    }
                    if (typeof topicStats[topicId].exercise3Accuracy !== 'number') {
                        topicStats[topicId].exercise3Accuracy = 0;
                    }
                    if (!topicStats[topicId].exercise1Stats) {
                        topicStats[topicId].exercise1Stats = { correct: 0, total: 0 };
                    }
                    if (!topicStats[topicId].exercise2Stats) {
                        topicStats[topicId].exercise2Stats = { correct: 0, total: 0 };
                    }
                    if (!topicStats[topicId].exercise3Stats) {
                        topicStats[topicId].exercise3Stats = { correct: 0, total: 0 };
                    }
                }
                if (!topicMistakes[topicId]) {
                    topicMistakes[topicId] = [];
                }
            }
            saveStats();
        }

        function saveStats() {
            localStorage.setItem('slovakTopicStats', JSON.stringify(topicStats));
            localStorage.setItem('slovakTopicMistakes', JSON.stringify(topicMistakes));
        }

        function updateAllWordsButtonProgress() {
            const allWordsCountEl = document.getElementById('allWordsCount');
            const allWordsProgressFill = document.getElementById('allWordsProgressFill');
            const allWordsProgressText = document.getElementById('allWordsProgressText');
            if (!topicsData.all || !topicsData.all.words) return;
            const total = topicsData.all.words.length;
            if (allWordsCountEl) {
                allWordsCountEl.textContent = total ? `${total} ${total === 1 ? '—Å–ª–æ–≤–æ' : total < 5 ? '—Å–ª–æ–≤–∞' : '—Å–ª–æ–≤'}` : '';
            }
            const stats = topicStats['all'] || { learned: [] };
            const learned = stats.learned ? stats.learned.length : 0;
            const progressPct = total > 0 ? Math.round((learned / total) * 100) : 0;
            if (allWordsProgressFill) allWordsProgressFill.style.width = progressPct + '%';
            if (allWordsProgressText) allWordsProgressText.textContent = total ? `${learned}/${total}` : '';
        }

        function renderTopics() {
            updateAllWordsButtonProgress();
            topicsList.innerHTML = '';
            
            for (const topicId in topicsData) {
                if (topicId === "all") continue;
                
                const topic = topicsData[topicId];
                const stats = topicStats[topicId] || { learned: [] };
                const mistakes = topicMistakes[topicId] || [];
                const learnedCount = stats.learned ? stats.learned.length : 0;
                const totalWords = topic.words.length;
                const progress = totalWords > 0 ? Math.round((learnedCount / totalWords) * 100) : 0;
                
                const topicCard = document.createElement('div');
                topicCard.className = 'topic-card';
                topicCard.dataset.topicId = topicId;
                
                topicCard.innerHTML = `
                    <div class="topic-icon">
                        <i class="${topic.icon}"></i>
                    </div>
                    <div class="topic-info">
                        <h3>${topic.name}</h3>
                        <p>${topic.description} ‚Ä¢ ${topic.words.length} —Å–ª–æ–≤</p>
                        <div class="topic-stats">
                            <span>${progress}%</span>
                            <div class="topic-progress">
                                <div class="topic-progress-fill" style="width: ${progress}%"></div>
                            </div>
                            <span>${mistakes.length} –æ—à–∏–±–æ–∫</span>
                        </div>
                    </div>
                `;
                
                topicCard.addEventListener('click', () => selectTopic(topicId));
                topicsList.appendChild(topicCard);
            }
        }

        function selectTopic(topicId) {
            currentTopic = topicsData[topicId];
            showScreen('main');
            updateTopicInfo();
        }

        function showScreen(screenName) {
            topicsScreen.classList.remove('active');
            mainScreen.classList.remove('active');
            exercise1Screen.classList.remove('active');
            exercise2Screen.classList.remove('active');
            exercise3Screen.classList.remove('active');
            wordsListScreen.classList.remove('active');
            
            if (screenName === 'topics' || screenName === 'main') {
                progressContainer.style.display = 'none';
                if (screenName === 'topics') {
                    headerTitle.textContent = 'Slovak Trainer';
                } else {
                    headerTitle.textContent = currentTopic ? currentTopic.name : '–¢–µ–º–∞';
                }
            } else {
                progressContainer.style.display = 'block';
                headerTitle.textContent = currentExercise === 'exercise1' ? '–í—ã–±–æ—Ä –ø–µ—Ä–µ–≤–æ–¥–∞' : 
                                          currentExercise === 'exercise2' ? '–°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ' :
                                          currentExercise === 'exercise3' ? '–î–∏–∫—Ç–∞–Ω—Ç' : '–°–ª–æ–≤–∞';
            }
            
            const appHeader = document.getElementById('appHeader');
            if (appHeader) appHeader.classList.add('header--left');
            
            if (screenName === 'topics') {
                topicsScreen.classList.add('active');
                backBtn.style.visibility = 'hidden';
                resetBtn.style.display = 'none';
                updateAllWordsButtonProgress();
            } else if (screenName === 'main') {
                mainScreen.classList.add('active');
                backBtn.style.visibility = 'visible';
                resetBtn.style.display = 'none';
                updateTopicProgress();
            } else if (screenName === 'exercise1') {
                exercise1Screen.classList.add('active');
                backBtn.style.visibility = 'visible';
                resetBtn.style.display = 'flex';
                updateLanguageSwitcherLabels();
                startExercise1(false);
            } else if (screenName === 'exercise2') {
                exercise2Screen.classList.add('active');
                backBtn.style.visibility = 'visible';
                resetBtn.style.display = 'flex';
                startExercise2();
            } else if (screenName === 'exercise3') {
                exercise3Screen.classList.add('active');
                backBtn.style.visibility = 'visible';
                resetBtn.style.display = 'flex';
                updateDictationLanguageSwitcher();
                startExercise3();
            } else if (screenName === 'wordsList') {
                wordsListScreen.classList.add('active');
                backBtn.style.visibility = 'visible';
                resetBtn.style.display = 'none';
                showWordsList();
            }
        }

        function updateTopicInfo() {
            if (!currentTopic) return;
            updateTopicProgress();
        }

        function updateTopicProgress() {
            if (!currentTopic) return;
            
            const stats = topicStats[currentTopic.id] || { learned: [] };
            const mistakes = topicMistakes[currentTopic.id] || [];
            const learnedCount = stats.learned ? stats.learned.length : 0;
            const totalWords = currentTopic.words.length;
            const progress = totalWords > 0 ? Math.round((learnedCount / totalWords) * 100) : 0;
            
            totalLearnedEl.textContent = learnedCount;
            
            const acc1 = typeof stats.exercise1Accuracy === 'number' ? stats.exercise1Accuracy : 0;
            const acc2 = typeof stats.exercise2Accuracy === 'number' ? stats.exercise2Accuracy : 0;
            const acc3 = typeof stats.exercise3Accuracy === 'number' ? stats.exercise3Accuracy : 0;
            const avgAccuracy = Math.round((acc1 + acc2 + acc3) / 3);
            totalAccuracyEl.textContent = (Number.isNaN(avgAccuracy) ? 0 : avgAccuracy) + '%';
            
            mistakesCountEl.textContent = mistakes.length;
            wordsInTopicEl.textContent = totalWords;
            if (repeatMistakesCountEl) repeatMistakesCountEl.textContent = '(' + mistakes.length + ')';
            
            let displayLearned = learnedCount;
            let displayTotal = totalWords;
            let displayProgress = progress;
            
            // –†–µ–∂–∏–º –ø–æ–º–∏–ª–æ–∫ —Ç—ñ–ª—å–∫–∏ –¥–ª—è exercise1
            if (currentExercise === 'exercise1' && exercise1MistakesMode) {
                const total = exercise1MistakesModeTotal;
                const completed = exercise1Queue.length === 0
                    ? total
                    : Math.max(0, total - exercise1Queue.length - 1);
                displayLearned = completed;
                displayTotal = total;
            }
            
            const progressBarEl = progressFill && progressFill.parentElement;
            
            // –î–ª—è exercise1 –≤ —Ä–µ–∂–∏–º—ñ –ø–æ–º–∏–ª–æ–∫ —Ö–æ–≤–∞—î–º–æ –ø—Ä–æ–≥—Ä–µ—Å-–±–∞—Ä
            if (currentExercise === 'exercise1' && exercise1MistakesMode) {
                progressText.style.display = 'none';
                if (progressBarEl) progressBarEl.style.display = 'none';
                wordsCount.textContent = `${displayLearned}/${displayTotal}`;
            } else {
                progressText.style.display = '';
                if (progressBarEl) progressBarEl.style.display = '';
                if (progressFill) progressFill.style.width = displayProgress + '%';
                progressText.textContent = `–ü—Ä–æ–≥—Ä–µ—Å—Å: ${displayProgress}%`;
                wordsCount.textContent = `–°–ª–æ–≤: ${displayLearned}/${displayTotal}`;
            }
        }

        function goToMainScreen() {
            if (currentExercise) {
                currentExercise = null;
                showScreen('main');
            } else if (currentTopic) {
                showScreen('topics');
            } else {
                showScreen('topics');
            }
        }

        function toggleSpeech() {
            speechEnabled = !speechEnabled;
            localStorage.setItem('slovakSpeechEnabled', speechEnabled);
            updateSoundButton();
        }

        function updateSoundButton() {
            soundToggleBtn.innerHTML = speechEnabled ? 
                '<i class="fas fa-volume-up"></i>' : 
                '<i class="fas fa-volume-mute"></i>';
            soundToggleBtn.classList.toggle('active', speechEnabled);
        }

        function speakWord(word, onEnd) {
            if (!speechEnabled || !window.speechSynthesis) {
                if (typeof onEnd === 'function') onEnd();
                return;
            }
            
            const utterance = new SpeechSynthesisUtterance(word);
            utterance.lang = 'sk-SK';
            utterance.rate = 0.8;
            
            if (typeof onEnd === 'function') {
                utterance.onend = onEnd;
                utterance.onerror = onEnd;
            }
            
            window.speechSynthesis.speak(utterance);
        }

        function speakCurrentWord() {
            if (!currentExercise1Current) return;
            speakWord(currentExercise1Current.sk);
        }

        function setupEventListeners() {
            backBtn.addEventListener('click', goToMainScreen);
            if (themeToggleBtn) themeToggleBtn.addEventListener('click', toggleTheme);
            soundToggleBtn.addEventListener('click', toggleSpeech);
            pronunciationBtn.addEventListener('click', speakCurrentWord);
            
            allWordsBtn.addEventListener('click', () => {
                selectTopic('all');
            });
            
            exercise1Card.addEventListener('click', () => {
                if (!currentTopic) return;
                currentExercise = 'exercise1';
                showScreen('exercise1');
            });
            
            exercise2Card.addEventListener('click', () => {
                if (!currentTopic) return;
                currentExercise = 'exercise2';
                showScreen('exercise2');
            });

            exercise3Card.addEventListener('click', () => {
                if (!currentTopic) return;
                currentExercise = 'exercise3';
                showScreen('exercise3');
            });
            
            viewWordsBtn.addEventListener('click', () => {
                if (!currentTopic) return;
                showScreen('wordsList');
            });
            
            repeatMistakesBtn.addEventListener('click', () => {
                if (!currentTopic) return;
                const mistakes = topicMistakes[currentTopic.id] || [];
                if (mistakes.length === 0) {
                    alert('–í —ç—Ç–æ–π —Ç–µ–º–µ –Ω–µ—Ç —Å–ª–æ–≤ —Å –æ—à–∏–±–∫–∞–º–∏!');
                    return;
                }
                currentExercise = 'exercise1';
                showScreen('exercise1');
                startExercise1(true);
            });

            resetTopicBtn.addEventListener('click', resetCurrentTopic);
            resetBtn.addEventListener('click', resetCurrentExercise);
        }

        function resetCurrentTopic() {
            if (!currentTopic) return;
            
            if (confirm(`–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ —Ç–µ–º–µ "${currentTopic.name}"?`)) {
                topicStats[currentTopic.id] = {
                    learned: [],
                    exercise1Accuracy: 0,
                    exercise2Accuracy: 0,
                    exercise3Accuracy: 0,
                    exercise1Stats: { correct: 0, total: 0 },
                    exercise2Stats: { correct: 0, total: 0 },
                    exercise3Stats: { correct: 0, total: 0 }
                };
                topicMistakes[currentTopic.id] = [];
                saveStats();
                updateTopicProgress();
                alert('–ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ —Ç–µ–º–µ —Å–±—Ä–æ—à–µ–Ω!');
            }
        }

        // ============================
        // –£–ü–†–ê–ñ–ù–ï–ù–ò–ï 1: –í–´–ë–û–† –ü–ï–†–ï–í–û–î–ê
        // ============================
        let exercise1Queue = [];
        let currentExercise1Current = null;
        let exercise1MistakesMode = false;
        let exercise1MistakesModeTotal = 0;

        function startExercise1(mistakesOnly = false) {
            if (!currentTopic) return;
            
            if (mistakesOnly) {
                const mistakes = topicMistakes[currentTopic.id] || [];
                if (mistakes.length === 0) {
                    alert('–í —ç—Ç–æ–π —Ç–µ–º–µ –Ω–µ—Ç —Å–ª–æ–≤ —Å –æ—à–∏–±–∫–∞–º–∏!');
                    goToMainScreen();
                    return;
                }
                exercise1Queue = currentTopic.words.filter(word => mistakes.includes(word.sk));
                exercise1MistakesMode = true;
                exercise1MistakesModeTotal = exercise1Queue.length;
            } else {
                const learned = topicStats[currentTopic.id]?.learned || [];
                exercise1Queue = currentTopic.words.filter(word => !learned.includes(word.sk));
                if (exercise1Queue.length === 0) {
                    exercise1Queue = [...currentTopic.words];
                }
                exercise1MistakesMode = false;
                exercise1MistakesModeTotal = 0;
            }
            
            shuffleArray(exercise1Queue);
            updateTopicProgress();
            nextQuestionExercise1();
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function nextQuestionExercise1() {
            if (exercise1Queue.length === 0) {
                if (exercise1MistakesMode) {
                    updateTopicProgress();
                    showCompletionModal('üéâ –í—Å–µ –æ—à–∏–±–∫–∏ –ø–æ–≤—Ç–æ—Ä–µ–Ω—ã!', '–í—ã —É—Å–ø–µ—à–Ω–æ –ø–æ–≤—Ç–æ—Ä–∏–ª–∏ –≤—Å–µ —Å–ª–æ–≤–∞ —Å –æ—à–∏–±–∫–∞–º–∏ –≤ —ç—Ç–æ–π —Ç–µ–º–µ.');
                } else {
                    showCompletionModal('–í—ã –≤—ã—É—á–∏–ª–∏ –≤—Å–µ —Å–ª–æ–≤–∞ –≤ —ç—Ç–æ–π —Ç–µ–º–µ!', '–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –æ—Å–≤–æ–∏–ª–∏ –≤—Å–µ —Å–ª–æ–≤–∞ –≤ —Ç–µ–∫—É—â–µ–π —Ç–µ–º–µ.');
                }
                return;
            }

            currentExercise1Current = exercise1Queue.shift();
            
            if (exercise1Direction === 'sk-ru') {
                currentWordEl.style.display = 'block';
                currentRussianWordEl.style.display = 'none';
                currentWordEl.textContent = currentExercise1Current.sk;
                currentPronunciationEl.textContent = ' ';
                directionHint.textContent = '–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥ —Å–ª–æ–≤–∞';
                pronunciationBtn.style.display = 'flex';
            } else {
                currentWordEl.style.display = 'none';
                currentRussianWordEl.style.display = 'block';
                currentRussianWordEl.textContent = currentExercise1Current.ru;
                currentPronunciationEl.textContent = '–ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ –Ω–∞ —Å–ª–æ–≤–∞—Ü–∫–∏–π —è–∑—ã–∫';
                directionHint.textContent = '–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥ –Ω–∞ —Å–ª–æ–≤–∞—Ü–∫–∏–π';
                pronunciationBtn.style.display = 'none';
            }

            let correctAnswer, options;
            
            if (exercise1Direction === 'sk-ru') {
                correctAnswer = currentExercise1Current.ru;
                let otherWords = currentTopic.words.filter(w => w.ru !== correctAnswer);
                shuffleArray(otherWords);
                options = [correctAnswer];
                options = options.concat(otherWords.slice(0, 5).map(w => w.ru)); // –ó–º—ñ–Ω–∏—Ç–∏ 3 –Ω–∞ 5
            } else {
                correctAnswer = currentExercise1Current.sk;
                let otherWords = currentTopic.words.filter(w => w.sk !== correctAnswer);
                shuffleArray(otherWords);
                options = [correctAnswer];
                options = options.concat(otherWords.slice(0, 5).map(w => w.sk)); // –ó–º—ñ–Ω–∏—Ç–∏ 3 –Ω–∞ 5
            }
            
            shuffleArray(options);

            optionsContainer.innerHTML = "";
            options.forEach(opt => {
                let btn = document.createElement("button");
                btn.className = "option-btn";
                btn.textContent = opt;
                btn.onclick = () => {
                    handleAnswerExercise1(btn, opt, correctAnswer);
                };
                optionsContainer.appendChild(btn);
            });

            correctFeedback.style.display = 'none';
            wrongFeedback.style.display = 'none';
            
            if (speechEnabled && exercise1Direction === 'sk-ru') {
                setTimeout(() => speakCurrentWord(), 300);
            }
        }

        function handleAnswerExercise1(buttonClicked, selected, correctAnswer) {
            const buttons = document.querySelectorAll(".option-btn");
            buttons.forEach(b => b.disabled = true);

            const stats = topicStats[currentTopic.id];
            if (stats) {
                if (!stats.exercise1Stats) {
                    stats.exercise1Stats = { correct: 0, total: 0 };
                }
                stats.exercise1Stats.total++;
                if (selected === correctAnswer) {
                    stats.exercise1Stats.correct++;
                }
                stats.exercise1Accuracy = stats.exercise1Stats.total > 0
                    ? Math.round((stats.exercise1Stats.correct / stats.exercise1Stats.total) * 100)
                    : 0;
            }

            const isCorrect = selected === correctAnswer;

            if (isCorrect) {
                buttonClicked.classList.add("correct", "correct-animation");
                correctFeedback.style.display = 'block';
                
                if (!topicStats[currentTopic.id].learned.includes(currentExercise1Current.sk)) {
                    topicStats[currentTopic.id].learned.push(currentExercise1Current.sk);
                }
                
                if (exercise1MistakesMode && topicMistakes[currentTopic.id]) {
                    topicMistakes[currentTopic.id] = topicMistakes[currentTopic.id].filter(sk => sk !== currentExercise1Current.sk);
                    if (currentTopic.id !== 'all' && topicMistakes['all']) {
                        topicMistakes['all'] = topicMistakes['all'].filter(sk => sk !== currentExercise1Current.sk);
                    }
                }
                
                saveStats();

                const goNext = () => {
                    nextQuestionExercise1();
                    updateTopicProgress();
                };

                if (exercise1Direction === 'ru-sk') {
                    speakWord(correctAnswer, goNext);
                } else {
                    setTimeout(goNext, 300);
                }
            } else {
                buttonClicked.classList.add("wrong", "wrong-animation");
                buttons.forEach(b => {
                    if (b.textContent === correctAnswer) {
                        b.classList.add("correct");
                        if (exercise1Direction === 'ru-sk') {
                            speakWord(correctAnswer);
                        }
                    }
                });

                wrongFeedback.style.display = 'block';
                correctAnswerText.textContent = correctAnswer;
                
                const mistakes = topicMistakes[currentTopic.id];
                if (!mistakes.includes(currentExercise1Current.sk)) {
                    mistakes.push(currentExercise1Current.sk);
                }

                if (currentTopic.id !== 'all' && topicMistakes['all']) {
                    const allMistakes = topicMistakes['all'];
                    if (!allMistakes.includes(currentExercise1Current.sk)) {
                        allMistakes.push(currentExercise1Current.sk);
                    }
                }
                
                saveStats();

                // –í—Å—Ç–∞–≤–∫–∞ —Å–ª–æ–≤–∞ —á–µ—Ä–µ–∑ 2 –≤–æ–ø—Ä–æ—Å–∞ –≤–º–µ—Å—Ç–æ –∫–æ–Ω—Ü–∞ –æ—á–µ—Ä–µ–¥–∏
                const insertPosition = Math.min(
                    exercise1Queue.length,
                    2 + Math.floor(Math.random() * 2) // 2 –∏–ª–∏ 3
                );
                exercise1Queue.splice(insertPosition, 0, currentExercise1Current);



                setTimeout(() => {
                    nextQuestionExercise1();
                    updateTopicProgress();
                }, 2000);
            }
        }

        // ==============================
        // –£–ü–†–ê–ñ–ù–ï–ù–ò–ï 2: –°–û–ü–û–°–¢–ê–í–õ–ï–ù–ò–ï
        // ==============================
        let selectedWord = null;
        let selectedColumn = null;
        let selectedElement = null;
        let currentExercise2Words = [];
        let exercise2Mistakes = [];
        let exercise2Round = 0;
        const EXERCISE2_WORDS_PER_ROUND = 6;

        function startExercise2() {
            if (!currentTopic) return;
            
            // –ü–æ–ª—É—á–∞–µ–º —Ç–æ–ª—å–∫–æ –Ω–µ–≤—ã—É—á–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞
            const learned = topicStats[currentTopic.id]?.learned || [];
            const unlearnedWords = currentTopic.words.filter(word => !learned.includes(word.sk));
            
            // –ï—Å–ª–∏ –Ω–µ–≤—ã—É—á–µ–Ω–Ω—ã—Ö —Å–ª–æ–≤ –Ω–µ—Ç, –±–µ—Ä–µ–º –≤—Å–µ —Å–ª–æ–≤–∞
            currentExercise2Words = unlearnedWords.length > 0 ? unlearnedWords : [...currentTopic.words];
            
            // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –∏ –±–µ—Ä–µ–º –ø–µ—Ä–≤—ã–µ 4 —Å–ª–æ–≤–∞ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Ä–∞—É–Ω–¥–∞
            shuffleArray(currentExercise2Words);
            exercise2Round = 0;
            
            selectedWord = null;
            selectedColumn = null;
            selectedElement = null;
            exercise2Mistakes = [];
            
            nextRoundExercise2();
        }

        function nextRoundExercise2() {
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, —Å–∫–æ–ª—å–∫–æ —Å–ª–æ–≤ –≤–∑—è—Ç—å –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ä–∞—É–Ω–¥–∞
            const startIndex = exercise2Round * EXERCISE2_WORDS_PER_ROUND;
            const roundWords = currentExercise2Words.slice(startIndex, startIndex + EXERCISE2_WORDS_PER_ROUND);
            
            // –ï—Å–ª–∏ —Å–ª–æ–≤ –¥–ª—è —Ä–∞—É–Ω–¥–∞ –Ω–µ—Ç –∏–ª–∏ –º—ã –ø—Ä–æ—à–ª–∏ –≤—Å–µ —Å–ª–æ–≤–∞
            if (roundWords.length === 0) {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—Å–µ –ª–∏ —Å–ª–æ–≤–∞ —Ç–µ–º—ã –≤—ã—É—á–µ–Ω—ã
                const stats = topicStats[currentTopic.id] || { learned: [] };
                const learnedCount = stats.learned ? stats.learned.length : 0;
                const totalWords = currentTopic.words.length;
                
                if (learnedCount >= totalWords) {
                    showCompletionModal('üéâ –í—ã –≤—ã—É—á–∏–ª–∏ –≤—Å–µ —Å–ª–æ–≤–∞ –≤ —ç—Ç–æ–π —Ç–µ–º–µ!', '–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –æ—Å–≤–æ–∏–ª–∏ –≤—Å–µ —Å–ª–æ–≤–∞ –≤ —Ç–µ–∫—É—â–µ–π —Ç–µ–º–µ.');
                } else {
                    // –ï—Å–ª–∏ –µ—â–µ –µ—Å—Ç—å –Ω–µ–≤—ã—É—á–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞, –Ω–∞—á–∏–Ω–∞–µ–º —Å–Ω–∞—á–∞–ª–∞
                    exercise2Round = 0;
                    nextRoundExercise2();
                }
                return;
            }
            
            displayMatchingWords(roundWords);
            exercise2Round++;
        }

        function displayMatchingWords(words) {
            russianWordsEl.innerHTML = '';
            slovakWordsEl.innerHTML = '';
            
            const russianWords = [...words].sort(() => Math.random() - 0.5);
            const slovakWords = [...words].sort(() => Math.random() - 0.5);
            
            russianWords.forEach(word => {
                const wordDiv = document.createElement('div');
                wordDiv.className = 'word-item';
                wordDiv.textContent = word.ru;
                wordDiv.dataset.word = word.sk;
                wordDiv.dataset.type = 'russian';
                wordDiv.onclick = () => handleWordSelection(wordDiv, 'russian', word.ru, word.sk);
                russianWordsEl.appendChild(wordDiv);
            });
            
            slovakWords.forEach(word => {
                const wordDiv = document.createElement('div');
                wordDiv.className = 'word-item';
                wordDiv.textContent = word.sk;
                wordDiv.dataset.word = word.sk;
                wordDiv.dataset.type = 'slovak';
                wordDiv.onclick = () => handleWordSelection(wordDiv, 'slovak', word.sk, word.ru);
                
                const soundIcon = document.createElement('div');
                soundIcon.className = 'sound-icon';
                soundIcon.innerHTML = '<i class="fas fa-volume-up"></i>';
                soundIcon.onclick = (e) => {
                    e.stopPropagation();
                    speakWord(word.sk);
                };
                wordDiv.appendChild(soundIcon);
                
                slovakWordsEl.appendChild(wordDiv);
            });
        }

        function handleWordSelection(element, column, wordText, pairedWord) {
            if (element.classList.contains('matched')) return;
            
            if (column === 'slovak' && speechEnabled) {
                speakWord(wordText);
            }
            
            document.querySelectorAll('.word-item.selected').forEach(el => {
                if (el !== selectedElement) {
                    el.classList.remove('selected');
                }
            });
            
            if (!selectedWord) {
                selectedWord = wordText;
                selectedColumn = column;
                selectedElement = element;
                selectedElement.dataset.pairedWord = pairedWord;
                element.classList.add('selected');
                return;
            }
            
            if (selectedColumn === column) {
                selectedElement.classList.remove('selected');
                selectedWord = wordText;
                selectedColumn = column;
                selectedElement = element;
                selectedElement.dataset.pairedWord = pairedWord;
                element.classList.add('selected');
                return;
            }
            
            checkPairExercise2(element, column, wordText, pairedWord);
        }

        function checkPairExercise2(element, column, wordText, pairedWord) {
            const savedSelectedElement = selectedElement;
            const savedSelectedWord = selectedWord;
            const savedSelectedColumn = selectedColumn;
            const savedPairedWord = savedSelectedElement.dataset.pairedWord;
            
            let isMatch = false;
            let matchedWord = null;
            
            if (column === 'russian') {
                isMatch = (wordText === savedPairedWord);
                if (isMatch) {
                    matchedWord = currentExercise2Words.find(word => 
                        word.sk === savedSelectedWord && word.ru === wordText
                    );
                }
            } else {
                isMatch = (wordText === savedPairedWord);
                if (isMatch) {
                    matchedWord = currentExercise2Words.find(word => 
                        word.sk === wordText && word.ru === savedSelectedWord
                    );
                }
            }

            const stats = topicStats[currentTopic.id];
            if (stats) {
                if (!stats.exercise2Stats) {
                    stats.exercise2Stats = { correct: 0, total: 0 };
                }
                stats.exercise2Stats.total++;
                if (isMatch) {
                    stats.exercise2Stats.correct++;
                }
                stats.exercise2Accuracy = stats.exercise2Stats.total > 0
                    ? Math.round((stats.exercise2Stats.correct / stats.exercise2Stats.total) * 100)
                    : 0;
            }
            
            if (isMatch) {
                handleCorrectMatchExercise2(element, savedSelectedElement, matchedWord);
            } else {
                if (savedSelectedColumn === 'russian') {
                    const mistakeWord = currentExercise2Words.find(word => word.ru === savedSelectedWord);
                    if (mistakeWord && !exercise2Mistakes.includes(mistakeWord.sk)) {
                        exercise2Mistakes.push(mistakeWord.sk);
                    }
                } else {
                    const mistakeWord = currentExercise2Words.find(word => word.sk === savedSelectedWord);
                    if (mistakeWord && !exercise2Mistakes.includes(mistakeWord.sk)) {
                        exercise2Mistakes.push(mistakeWord.sk);
                    }
                }
                
                if (column === 'russian') {
                    const mistakeWord = currentExercise2Words.find(word => word.ru === wordText);
                    if (mistakeWord && !exercise2Mistakes.includes(mistakeWord.sk)) {
                        exercise2Mistakes.push(mistakeWord.sk);
                    }
                } else {
                    const mistakeWord = currentExercise2Words.find(word => word.sk === wordText);
                    if (mistakeWord && !exercise2Mistakes.includes(mistakeWord.sk)) {
                        exercise2Mistakes.push(mistakeWord.sk);
                    }
                }
                
                handleWrongMatchExercise2(element, savedSelectedElement);
            }
        }

        function handleCorrectMatchExercise2(secondElement, firstElement, matchedWord) {
            secondElement.classList.add('matched');
            secondElement.classList.remove('selected');
            firstElement.classList.add('matched');
            firstElement.classList.remove('selected');
            
            if (matchedWord && !topicStats[currentTopic.id].learned.includes(matchedWord.sk)) {
                topicStats[currentTopic.id].learned.push(matchedWord.sk);
            }
            
            if (matchedWord && exercise2Mistakes.includes(matchedWord.sk)) {
                const mistakes = topicMistakes[currentTopic.id];
                if (!mistakes.includes(matchedWord.sk)) {
                    mistakes.push(matchedWord.sk);
                }
                if (currentTopic.id !== 'all' && topicMistakes['all']) {
                    const allMistakes = topicMistakes['all'];
                    if (!allMistakes.includes(matchedWord.sk)) {
                        allMistakes.push(matchedWord.sk);
                    }
                }
            }
            
            saveStats();
            
            selectedWord = null;
            selectedColumn = null;
            selectedElement = null;
            
            updateTopicProgress();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—Å–µ –ª–∏ —Å–ª–æ–≤–∞ –≤ —Ç–µ–∫—É—â–µ–º —Ä–∞—É–Ω–¥–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω—ã
            const allMatched = document.querySelectorAll('.word-item:not(.matched)').length === 0;
            
            if (allMatched) {
                exercise2Mistakes.forEach(wordSk => {
                    const mistakes = topicMistakes[currentTopic.id];
                    if (!mistakes.includes(wordSk)) {
                        mistakes.push(wordSk);
                    }
                    if (currentTopic.id !== 'all' && topicMistakes['all']) {
                        const allMistakes = topicMistakes['all'];
                        if (!allMistakes.includes(wordSk)) {
                            allMistakes.push(wordSk);
                        }
                    }
                });
                saveStats();
                updateTopicProgress();
                
                setTimeout(() => {
                    nextRoundExercise2();
                }, 1000);
            }
        }

        function handleWrongMatchExercise2(secondElement, firstElement) {
            secondElement.classList.add('wrong', 'wrong-animation');
            firstElement.classList.add('wrong', 'wrong-animation');
            
            setTimeout(() => {
                secondElement.classList.remove('wrong', 'selected');
                firstElement.classList.remove('wrong', 'selected');
                selectedWord = null;
                selectedColumn = null;
                selectedElement = null;
                updateTopicProgress();
            }, 1000);
        }

        // ==============================
        // –£–ü–†–ê–ñ–ù–ï–ù–ò–ï 3: –î–ò–ö–¢–ê–ù–¢
        // ==============================
        const DICTATION_STREAK_TO_LEARN = 2;
        const DICTATION_HINT_FIRST_LETTERS = 1;

        const DICTATION_QUEUE_POS_WRONG = 2;
        const DICTATION_QUEUE_POS_TYPO = 4;
        const DICTATION_QUEUE_POS_EXACT_REINFORCE = 6;

        let exercise3Queue = [];
        let currentExercise3Current = null;

        // streak –ø–æ —Å–ª–æ–≤–∞–º (–∫–ª—é—á ‚Äî —Å–ª–æ–≤–∞—Ü–∫–æ–µ —Å–ª–æ–≤–æ)
        let exercise3StreakMap = {};
        let exercise3UsedHintForCurrent = false;
        let exercise3AnsweredThisQuestion = false;
        let exercise3AutoNextTimeout = null;

        function normalizeTextForCompare(text) {
            let s = (text || '').toString();

            // –ë–∞–∑–æ–≤–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
            s = s.trim().toLowerCase().replace(/\s+/g, ' ');

            // —ë -> –µ (–Ω–∞ —Å–ª—É—á–∞–π —Ä—É—Å—Å–∫–∏—Ö –æ—Ç–≤–µ—Ç–æ–≤)
            s = s.replace(/—ë/g, '–µ');

            // –°–Ω—è—Ç–∏–µ –¥–∏–∞–∫—Ä–∏—Ç–∏–∫–∏ (–≤–∞–∂–Ω–æ: –Ω–µ –ª–æ–º–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–æ–¥—Ö–æ–¥)
            s = s.normalize('NFD').replace(/\p{Diacritic}/gu, '');

            // –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –¥–µ—Ñ–∏—Å—ã/—Ç–∏—Ä–µ -> –ø—Ä–æ–±–µ–ª
            s = s.replace(/[\-\u2010\u2011\u2012\u2013\u2014\u2015]/g, ' ');

            // –£–¥–∞–ª–∏—Ç—å –ø—É–Ω–∫—Ç—É–∞—Ü–∏—é/—Å–∏–º–≤–æ–ª—ã (–≤–∫–ª—é—á–∞—è ‚Äú‚Ä¶‚Äù –∏ –ø–æ–¥–æ–±–Ω–æ–µ)
            // (–ü—É–Ω–∫—Ç—É–∞—Ü–∏—è -> –ø—Ä–æ–±–µ–ª, —á—Ç–æ–±—ã –Ω–µ —Å–∫–ª–µ–∏–≤–∞—Ç—å —Å–ª–æ–≤–∞)
            s = s.replace(/[\p{P}\p{S}]+/gu, ' ');

            // –§–∏–Ω–∞–ª—å–Ω–∞—è —á–∏—Å—Ç–∫–∞ –ø—Ä–æ–±–µ–ª–æ–≤
            s = s.replace(/\s+/g, ' ').trim();
            return s;
        }

        // –û—Å—Ç–∞–≤–ª–µ–Ω–æ –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å —Ç–µ–∫—É—â–µ–π –ª–æ–≥–∏–∫–æ–π (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–∏ 3)
        function stripDiacritics(text) {
            return normalizeTextForCompare(text);
        }

        function levenshteinDistance(a, b) {
            const s = a || '';
            const t = b || '';
            const n = s.length;
            const m = t.length;
            if (n === 0) return m;
            if (m === 0) return n;

            const dp = Array.from({ length: n + 1 }, () => new Array(m + 1).fill(0));
            for (let i = 0; i <= n; i++) dp[i][0] = i;
            for (let j = 0; j <= m; j++) dp[0][j] = j;

            for (let i = 1; i <= n; i++) {
                for (let j = 1; j <= m; j++) {
                    const cost = s[i - 1] === t[j - 1] ? 0 : 1;
                    dp[i][j] = Math.min(
                        dp[i - 1][j] + 1,
                        dp[i][j - 1] + 1,
                        dp[i - 1][j - 1] + cost
                    );
                }
            }
            return dp[n][m];
        }

        // Damerau-lite: –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–≤—É—Ö —Å–æ—Å–µ–¥–Ω–∏—Ö –±—É–∫–≤ —Å—á–∏—Ç–∞–µ—Ç—Å—è –∑–∞ 1 –æ—à–∏–±–∫—É
        function isAdjacentTransposition(a, b) {
            if (!a || !b) return false;
            if (a.length !== b.length) return false;
            if (a === b) return false;

            const diffs = [];
            for (let i = 0; i < a.length; i++) {
                if (a[i] !== b[i]) diffs.push(i);
                if (diffs.length > 2) return false;
            }
            if (diffs.length !== 2) return false;

            const [i, j] = diffs;
            if (j !== i + 1) return false;

            return a[i] === b[j] && a[j] === b[i];
        }

        function getAllowedTypoDistance(maxLen) {
            // –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –ø–æ—Ä–æ–≥: —á–µ–º –¥–ª–∏–Ω–Ω–µ–µ —Å–ª–æ–≤–æ/—Ñ—Ä–∞–∑–∞, —Ç–µ–º –±–æ–ª—å—à–µ –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –æ–ø–µ—á–∞—Ç–æ–∫
            let allowed = 1;
            if (maxLen >= 5 && maxLen <= 7) allowed = 2;
            if (maxLen >= 8 && maxLen <= 11) allowed = 3;
            if (maxLen >= 12) allowed = 4;
            return allowed;
        }

        function classifyDictationAnswer(userAnswerRaw, correctAnswerRaw) {
            const user = normalizeTextForCompare(userAnswerRaw);
            const correct = normalizeTextForCompare(correctAnswerRaw);

            if (!user) {
                return { type: 'wrong', user, correct, distance: null };
            }
            if (user === correct) {
                return { type: 'exact', user, correct, distance: 0 };
            }

            const maxLen = Math.max(user.length, correct.length);
            if (maxLen === 0) return { type: 'wrong', user, correct, distance: null };

            let dist = levenshteinDistance(user, correct);

            // –ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–æ—Å–µ–¥–Ω–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤ (Damerau-lite) ‚Äî —Å—á–∏—Ç–∞–µ–º –∫–∞–∫ 1 –æ—à–∏–±–∫—É
            if (isAdjacentTransposition(user, correct)) {
                dist = Math.min(dist, 1);
            }

            const allowed = getAllowedTypoDistance(maxLen);
            const ratio = dist / maxLen;

            if (dist <= allowed && ratio <= 0.34) {
                return { type: 'typo', user, correct, distance: dist };
            }
            return { type: 'wrong', user, correct, distance: dist };
        }

        function insertIntoQueue(queue, item, position) {
            if (!Array.isArray(queue)) return;
            const pos = Math.max(0, Math.min(position, queue.length));
            queue.splice(pos, 0, item);
        }

        function getExercise3WordKey(word) {
            return word && word.sk ? word.sk : '';
        }

        function getExercise3CurrentStreak() {
            const key = getExercise3WordKey(currentExercise3Current);
            if (!key) return 0;
            return Number(exercise3StreakMap[key] || 0) || 0;
        }

        function setExercise3CurrentStreak(value) {
            const key = getExercise3WordKey(currentExercise3Current);
            if (!key) return;
            exercise3StreakMap[key] = Math.max(0, Number(value) || 0);
        }

        function updateDictationMetricsUI() {
            if (!currentTopic) return;
            const stats = topicStats[currentTopic.id] || {};
            const st = stats.exercise3Stats || { correct: 0, total: 0, exactCorrect: 0 };

            const total = Number(st.total || 0) || 0;
            const acceptedCorrect = Number(st.correct || 0) || 0;
            const exactCorrect = Number(st.exactCorrect || 0) || 0;

            const acceptedAccuracy = total > 0 ? Math.round((acceptedCorrect / total) * 100) : 0;
            const exactAccuracy = total > 0 ? Math.round((exactCorrect / total) * 100) : 0;

            if (dictationAcceptedAccuracyEl) dictationAcceptedAccuracyEl.textContent = acceptedAccuracy + '%';
            if (dictationExactAccuracyEl) dictationExactAccuracyEl.textContent = exactAccuracy + '%';
            if (dictationWordStreakEl) dictationWordStreakEl.textContent = String(getExercise3CurrentStreak());

            const learned = stats.learned ? stats.learned.length : 0;
            if (dictationLearnedCountEl) dictationLearnedCountEl.textContent = String(learned);
        }

        function updateDictationCheckButtonState() {
            if (!dictationCheckBtn) return;
            const raw = dictationInputEl ? dictationInputEl.value : '';
            const isEmpty = !raw || !raw.trim();
            dictationCheckBtn.disabled = isEmpty || exercise3AnsweredThisQuestion;
        }

        function resetDictationHintsUI() {
            if (dictationExtraHintEl) {
                dictationExtraHintEl.innerHTML = '';
                dictationExtraHintEl.style.display = 'none';
            }
            // –ù–ï –ë–õ–û–ö–ò–†–£–ï–ú –ö–ù–û–ü–ö–£
            // if (dictationHintFirstBtn) dictationHintFirstBtn.disabled = false;
            // if (dictationHintLenBtn) dictationHintLenBtn.disabled = false;
        }
        
        function resetHintProgressForCurrentWord() {
            if (currentExercise3Current) {
                currentExercise3Current.hintProgress = 0;
            }
            // –û—á–∏—â–∞–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏
            if (dictationExtraHintEl) {
                dictationExtraHintEl.innerHTML = '';
                dictationExtraHintEl.style.display = 'none';
            }
            if (dictationHintFirstBtn) {
                dictationHintFirstBtn.disabled = false;
                dictationHintFirstBtn.style.opacity = '1';
            }
        }

        function renderDictationHint(kind) {
            if (!currentExercise3Current || !currentTopic) return;
            const { answerText } = getDictationPromptAndAnswer(currentExercise3Current);
            
            if (!dictationExtraHintEl) return;
            
            if (kind === 'first') {
                const trimmed = (answerText || '').toString().trim();
                
                // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–¥—Å–∫–∞–∑–æ–∫ –¥–ª—è —ç—Ç–æ–≥–æ —Å–ª–æ–≤–∞
                if (!currentExercise3Current.hintProgress) {
                    currentExercise3Current.hintProgress = 0;
                }
                
                // –ï—Å–ª–∏ —ç—Ç–æ –ø–µ—Ä–≤–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Å–ª–æ–≤–∞
                if (currentExercise3Current.hintProgress === 0) {
                    // –°–æ–∑–¥–∞–µ–º div –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —É–≥–∞–¥–∞–Ω–Ω—ã—Ö –±—É–∫–≤
                    const hintDiv = document.createElement('div');
                    hintDiv.id = 'hint-progress-display';
                    dictationExtraHintEl.innerHTML = '';
                    dictationExtraHintEl.appendChild(hintDiv);
                }
                
                // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–¥—Å–∫–∞–∑–∫–∏ –Ω–∞ 1 –±—É–∫–≤—É
                currentExercise3Current.hintProgress = Math.min(
                    currentExercise3Current.hintProgress + 1,
                    trimmed.length
                );
                
                // –°—Ç—Ä–æ–∏–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ: —É–≥–∞–¥–∞–Ω–Ω—ã–µ –±—É–∫–≤—ã + –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è
                let displayText = '';
                for (let i = 0; i < trimmed.length; i++) {
                    if (i < currentExercise3Current.hintProgress) {
                        displayText += trimmed[i] + ' ';
                    } else {
                        displayText += '_ ';
                    }
                }
                
                const hintDisplay = document.getElementById('hint-progress-display');
                if (hintDisplay) {
                    hintDisplay.innerHTML = `–ü–æ–¥—Å–∫–∞–∑–∫–∞: ${displayText.trim()}`;
                    hintDisplay.style.fontSize = '1.2rem';
                    hintDisplay.style.letterSpacing = '2px';
                }
                
                dictationExtraHintEl.style.display = 'block';
                
                // –ù–µ –±–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É - –º–æ–∂–Ω–æ –Ω–∞–∂–∏–º–∞—Ç—å –º–Ω–æ–≥–æ —Ä–∞–∑
                // –ü—Ä–æ—Å—Ç–æ –≤–∏–∑—É–∞–ª—å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ –∫–Ω–æ–ø–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
                if (dictationHintFirstBtn) {
                    dictationHintFirstBtn.style.opacity = '1';
                    dictationHintFirstBtn.disabled = false;
                }
            } else if (kind === 'len') {
                const norm = normalizeTextForCompare(answerText);
                const len = norm ? norm.replace(/\s/g, '').length : 0;
                const mask = len > 0 ? Array.from({ length: len }, () => '_').join(' ') : '‚Äî';
                dictationExtraHintEl.textContent = len > 0 ? `–ü–æ–¥—Å–∫–∞–∑–∫–∞: ${mask} (–¥–ª–∏–Ω–∞: ${len})` : '–ü–æ–¥—Å–∫–∞–∑–∫–∞: ‚Äî';
                dictationExtraHintEl.style.display = 'block';
            }
        }

        function clearDictationAutoNext() {
            if (exercise3AutoNextTimeout) {
                clearTimeout(exercise3AutoNextTimeout);
                exercise3AutoNextTimeout = null;
            }
        }

        function dictationGoNextNow() {
            // —Ä—É—á–Ω–æ–π –ø–µ—Ä–µ—Ö–æ–¥ –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å —Å—Ä–∞–∑—É –∏ –æ—Ç–º–µ–Ω—è—Ç—å –∞–≤—Ç–æ-–ø–µ—Ä–µ—Ö–æ–¥
            clearDictationAutoNext();
            nextQuestionExercise3();
        }

        function getDictationPromptAndAnswer(word) {
            const isTopic7 = currentTopic && currentTopic.id === 'topic7';
            const isTopic8 = currentTopic && currentTopic.id === 'topic8';
            const isTopic9 = currentTopic && currentTopic.id === 'topic9'; // ‚Üê –î–û–î–ê–¢–ò
        
            const nativeLabel = (isTopic7 || isTopic8 || isTopic9) ? '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞' : '–†—É—Å—Å–∫–∏–π'; // ‚Üê –í–ò–ü–†–ê–í–ò–¢–ò
            const slovakLabel = '–°–ª–æ–≤–∞—Ü–∫–∏–π';
        
            if (exercise3Direction === 'ru-sk') {
                return {
                    promptText: word.ru,
                    answerText: word.sk,
                    hint: `${nativeLabel} ‚Üí ${slovakLabel}`,
                    speakSk: true
                };
            }
            return {
                promptText: word.sk,
                answerText: word.ru,
                hint: `${slovakLabel} ‚Üí ${nativeLabel}`,
                speakSk: true
            };
        }

        function startExercise3() {
            if (!currentTopic) return;

            // –ü–æ–¥—Ç—è–Ω–µ–º –ø–æ–¥–ø–∏—Å–∏ (–≤–∞–∂–Ω–æ, –µ—Å–ª–∏ —Ç–µ–º–∞ –Ω–∞ —É–∫—Ä–∞–∏–Ω—Å–∫–æ–º)
            updateDictationLanguageSwitcher();

            // –°–±—Ä–æ—Å –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–∏–∫—Ç–∞–Ω—Ç–∞ (–±–µ–∑ –≤–ª–∏—è–Ω–∏—è –Ω–∞ –¥—Ä—É–≥–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è)
            exercise3StreakMap = {};
            exercise3UsedHintForCurrent = false;
            exercise3AnsweredThisQuestion = false;
            clearDictationAutoNext();
            resetDictationHintsUI();

            // –¢–æ–ª—å–∫–æ –Ω–µ–≤—ã—É—á–µ–Ω–Ω—ã–µ, –∏–Ω–∞—á–µ –≤—Å–µ
            const learned = topicStats[currentTopic.id]?.learned || [];
            const unlearnedWords = currentTopic.words.filter(word => !learned.includes(word.sk));
            exercise3Queue = unlearnedWords.length > 0 ? unlearnedWords : [...currentTopic.words];

            shuffleArray(exercise3Queue);

            if (dictationInputEl) {
                dictationInputEl.value = '';
                dictationInputEl.disabled = false;
                dictationInputEl.focus();
            }

            if (dictationCorrectFeedback) dictationCorrectFeedback.style.display = 'none';
            if (dictationTypoFeedback) dictationTypoFeedback.style.display = 'none';
            if (dictationWrongFeedback) dictationWrongFeedback.style.display = 'none';

            if (dictationNextBtn) dictationNextBtn.disabled = true;

            nextQuestionExercise3();
            updateTopicProgress();
        }

        function nextQuestionExercise3() {
            if (!currentTopic) return;
        
            clearDictationAutoNext();
        
            if (exercise3Queue.length === 0) {
                const stats = topicStats[currentTopic.id] || { learned: [] };
                const learnedCount = stats.learned ? stats.learned.length : 0;
                const totalWords = currentTopic.words.length;
        
                if (learnedCount >= totalWords) {
                    showCompletionModal('üéâ –í—ã –≤—ã—É—á–∏–ª–∏ –≤—Å–µ —Å–ª–æ–≤–∞ –≤ —ç—Ç–æ–π —Ç–µ–º–µ!', '–û—Ç–ª–∏—á–Ω–æ! –î–∏–∫—Ç–∞–Ω—Ç –ø—Ä–æ–π–¥–µ–Ω –¥–ª—è –≤—Å–µ—Ö —Å–ª–æ–≤ —Ç–µ–∫—É—â–µ–π —Ç–µ–º—ã.');
                } else {
                    showCompletionModal('‚úÖ –†–∞—É–Ω–¥ –∑–∞–≤–µ—Ä—à—ë–Ω!', '–•–æ—Ä–æ—à–∞—è —Ä–∞–±–æ—Ç–∞! –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ, —á—Ç–æ–±—ã –∑–∞–∫—Ä–µ–ø–∏—Ç—å —Å–ª–æ–≤–∞.');
                }
                return;
            }
        
            currentExercise3Current = exercise3Queue.shift();

            // –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤–æ–ø—Ä–æ—Å–∞
            exercise3UsedHintForCurrent = false;
            exercise3AnsweredThisQuestion = false;
            resetDictationHintsUI();

            const { promptText, hint } = getDictationPromptAndAnswer(currentExercise3Current);

            if (dictationPromptEl) dictationPromptEl.textContent = promptText;
            if (dictationHintEl) dictationHintEl.textContent = hint;

            if (dictationInputEl) {
                dictationInputEl.value = '';
                dictationInputEl.disabled = false;
                dictationInputEl.focus();
            }

            if (dictationCorrectFeedback) dictationCorrectFeedback.style.display = 'none';
            if (dictationTypoFeedback) dictationTypoFeedback.style.display = 'none';
            if (dictationWrongFeedback) dictationWrongFeedback.style.display = 'none';

            if (dictationNextBtn) dictationNextBtn.disabled = true;

            updateDictationMetricsUI();
            updateDictationCheckButtonState();
            updateTopicProgress(); // ‚Üê –í–°–¢–ê–í–ò–¢–ò –°–Æ–î–ò
        }

        function updateExercise3AccuracyByResult(resultType) {
            const stats = topicStats[currentTopic.id];
            if (!stats) return;

            if (!stats.exercise3Stats) stats.exercise3Stats = { correct: 0, total: 0, exactCorrect: 0 };
            if (typeof stats.exercise3Stats.exactCorrect !== 'number') stats.exercise3Stats.exactCorrect = 0;

            stats.exercise3Stats.total = Number(stats.exercise3Stats.total || 0) + 1;

            if (resultType === 'exact') {
                stats.exercise3Stats.correct = Number(stats.exercise3Stats.correct || 0) + 1; // accepted
                stats.exercise3Stats.exactCorrect = Number(stats.exercise3Stats.exactCorrect || 0) + 1;
            } else if (resultType === 'typo') {
                stats.exercise3Stats.correct = Number(stats.exercise3Stats.correct || 0) + 1; // accepted
            }

            const total = Number(stats.exercise3Stats.total || 0) || 0;
            const acceptedCorrect = Number(stats.exercise3Stats.correct || 0) || 0;

            // exercise3Accuracy —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∫–∞–∫ acceptedAccuracy (–æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ç–µ–∫—É—â–∏–º UI)
            stats.exercise3Accuracy = total > 0 ? Math.round((acceptedCorrect / total) * 100) : 0;
        }

        function removeWordFromMistakes(wordSk) {
            if (!currentTopic || !wordSk) return;

            const mistakes = topicMistakes[currentTopic.id] || [];
            const idx = mistakes.indexOf(wordSk);
            if (idx !== -1) mistakes.splice(idx, 1);

            if (currentTopic.id !== 'all' && topicMistakes['all']) {
                const allMistakes = topicMistakes['all'];
                const idxAll = allMistakes.indexOf(wordSk);
                if (idxAll !== -1) allMistakes.splice(idxAll, 1);
            }
        }

        function addWordToMistakes(wordSk) {
            if (!currentTopic || !wordSk) return;

            const mistakes = topicMistakes[currentTopic.id];
            if (mistakes && !mistakes.includes(wordSk)) mistakes.push(wordSk);

            if (currentTopic.id !== 'all' && topicMistakes['all']) {
                const allMistakes = topicMistakes['all'];
                if (allMistakes && !allMistakes.includes(wordSk)) allMistakes.push(wordSk);
            }
        }

        function markWordLearned(wordSk) {
            if (!currentTopic || !wordSk) return;
            if (!topicStats[currentTopic.id].learned.includes(wordSk)) {
                topicStats[currentTopic.id].learned.push(wordSk);
            }
        }

        function checkDictationAnswer() {
            if (!currentTopic || !currentExercise3Current) return;
            if (exercise3AnsweredThisQuestion) return;
        
            const { answerText } = getDictationPromptAndAnswer(currentExercise3Current);
            const userAnswerRaw = (dictationInputEl ? dictationInputEl.value : '');
        
            if (!userAnswerRaw || !userAnswerRaw.trim()) {
                updateDictationCheckButtonState();
                return;
            }
        
            const result = classifyDictationAnswer(userAnswerRaw, answerText);
        
            // –û–∑–≤—É—á–∏–≤–∞–µ–º —Å–ª–æ–≤–∞—Ü–∫–∏–π –≤–∞—Ä–∏–∞–Ω—Ç –≤—Å–µ–≥–¥–∞ (—ç—Ç–æ –∏ –µ—Å—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ–∏–∑–Ω–æ—à–µ–Ω–∏—è)
            speakWord(currentExercise3Current.sk);
        
            exercise3AnsweredThisQuestion = true;
            if (dictationInputEl) dictationInputEl.disabled = true;
        
            if (dictationCheckBtn) dictationCheckBtn.disabled = true;
            if (dictationNextBtn) dictationNextBtn.disabled = false;
        
            const wordKey = getExercise3WordKey(currentExercise3Current);
        
            // –û–±–Ω–æ–≤–ª—è–µ–º –º–µ—Ç—Ä–∏–∫–∏ —Ç–æ—á–Ω–æ—Å—Ç–∏
            updateExercise3AccuracyByResult(result.type);
        
            // Streak / ‚Äú–≤—ã—É—á–µ–Ω–Ω–æ—Å—Ç—å‚Äù
            let streak = Number(exercise3StreakMap[wordKey] || 0) || 0;
        
            if (result.type === 'exact' && !exercise3UsedHintForCurrent) {
                streak += 1;
            } else {
                // Typo / Wrong / Exact —Å –ø–æ–¥—Å–∫–∞–∑–∫–æ–π ‚Äî —Å–±—Ä–∞—Å—ã–≤–∞–µ–º streak, —á—Ç–æ–±—ã ‚Äú2 Exact –ø–æ–¥—Ä—è–¥‚Äù —Ä–∞–±–æ—Ç–∞–ª–æ —Å—Ç—Ä–æ–≥–æ
                streak = 0;
            }
            exercise3StreakMap[wordKey] = streak;
        
            const learnedNow = (result.type === 'exact' && !exercise3UsedHintForCurrent && streak >= DICTATION_STREAK_TO_LEARN);
        
            // UX: –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å –∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –ø—Ä–∏ Typo/Wrong
            if (dictationCorrectFeedback) dictationCorrectFeedback.style.display = 'none';
            if (dictationTypoFeedback) dictationTypoFeedback.style.display = 'none';
            if (dictationWrongFeedback) dictationWrongFeedback.style.display = 'none';
        
            if (result.type === 'exact') {
                if (dictationCorrectAnswerText) dictationCorrectAnswerText.textContent = answerText;
                if (dictationCorrectFeedback) dictationCorrectFeedback.style.display = 'block';
                removeWordFromMistakes(wordKey);
            } else if (result.type === 'typo') {
                if (dictationTypoAnswerText) dictationTypoAnswerText.textContent = answerText;
                if (dictationTypoFeedback) dictationTypoFeedback.style.display = 'block';
                addWordToMistakes(wordKey);
            } else {
                if (dictationCorrectAnswerTextWrong) dictationCorrectAnswerTextWrong.textContent = answerText;
                if (dictationWrongFeedback) dictationWrongFeedback.style.display = 'block';
                addWordToMistakes(wordKey);
            }
        
            // –û—á–µ—Ä–µ–¥—å (micro-spaced repetition)
            if (learnedNow) {
                markWordLearned(wordKey);
                removeWordFromMistakes(wordKey);
                updateTopicProgress();        // ‚Üê –î–û–î–ê–ù–û
                updateDictationMetricsUI();   // ‚Üê –î–û–î–ê–ù–û
            } else {
                const pos = result.type === 'wrong'
                    ? DICTATION_QUEUE_POS_WRONG
                    : result.type === 'typo'
                        ? DICTATION_QUEUE_POS_TYPO
                        : DICTATION_QUEUE_POS_EXACT_REINFORCE;
        
                insertIntoQueue(exercise3Queue, currentExercise3Current, Math.min(pos, exercise3Queue.length));
            }
        
            saveStats();
            updateTopicProgress();
            updateDictationMetricsUI();
        
            // –ê–≤—Ç–æ–ø–µ—Ä–µ—Ö–æ–¥ –æ—Å—Ç–∞–≤–ª—è–µ–º, –Ω–æ ‚Äú–î–∞–ª—å—à–µ‚Äù –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å —Å—Ä–∞–∑—É
            clearDictationAutoNext();
            const delay = (result.type === 'exact') ? 1100 : 1700;
            exercise3AutoNextTimeout = setTimeout(() => {
                // –∑–∞—â–∏—Ç–∞ –æ—Ç –¥–≤–æ–π–Ω–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞
                if (currentExercise === 'exercise3') {
                    nextQuestionExercise3();
                }
            }, delay);
        }
        
function showWordsList() {
            if (!currentTopic) return;
            
            wordsListTitle.textContent = `–°–ª–æ–≤–∞: ${currentTopic.name}`;
            wordsListContainer.innerHTML = '';
            
            currentTopic.words.forEach(word => {
                const wordItem = document.createElement('div');
                wordItem.className = 'word-list-item';
                
                const wordText = document.createElement('div');
                wordText.className = 'word-list-text';
                wordText.innerHTML = `
                    <div class="word-list-slovak">${word.sk}</div>
                    <div class="word-list-russian">${word.ru}</div>
                `;
                
                const soundBtn = document.createElement('div');
                soundBtn.className = 'word-list-sound';
                soundBtn.innerHTML = '<i class="fas fa-volume-up"></i>';
                soundBtn.onclick = (e) => {
                    e.stopPropagation();
                    speakWord(word.sk);
                };
                
                wordItem.appendChild(wordText);
                wordItem.appendChild(soundBtn);
                
                wordItem.onclick = () => {
                    speakWord(word.sk);
                };
                
                wordsListContainer.appendChild(wordItem);
            });
        }

        // ==============================
        // –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ó–ê–í–ï–†–®–ï–ù–ò–Ø
        // ==============================
        function showCompletionModal(title, message) {
            const modal = document.createElement('div');
            modal.className = 'completion-modal';
            modal.innerHTML = `
                <div class="completion-content">
                    <div class="completion-icon">üéâ</div>
                    <h3 class="completion-title">${title}</h3>
                    <p class="completion-text">${message}</p>
                    <div class="completion-buttons">
                        <button class="completion-btn completion-btn-secondary" id="modalCloseBtn">
                            –í–µ—Ä–Ω—É—Ç—å—Å—è
                        </button>
                        <button class="completion-btn completion-btn-primary" id="modalContinueBtn">
                            –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            document.getElementById('modalCloseBtn').addEventListener('click', () => {
                document.body.removeChild(modal);
                goToMainScreen();
            });
            
            document.getElementById('modalContinueBtn').addEventListener('click', () => {
                document.body.removeChild(modal);
                if (currentExercise === 'exercise1') {
                    startExercise1(false);
                } else if (currentExercise === 'exercise2') {
                    startExercise2();
                } else if (currentExercise === 'exercise3') {
                    startExercise3();
                }
            });
        }

        function resetCurrentExercise() {
            if (!currentTopic || !currentExercise) return;
            
            const confirmMsg = currentExercise === 'exercise1' 
                ? '–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è "–í—ã–±–æ—Ä –ø–µ—Ä–µ–≤–æ–¥–∞"?' 
                : currentExercise === 'exercise2'
                    ? '–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è "–°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–ª–æ–≤"?'
                    : '–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è "–î–∏–∫—Ç–∞–Ω—Ç"?';
            
            if (confirm(confirmMsg)) {
                if (currentExercise === 'exercise1') {
                    startExercise1(false);
                } else if (currentExercise === 'exercise2') {
                    startExercise2();
                } else {
                    startExercise3();
                }
                updateTopicProgress();
            }
        }

        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>